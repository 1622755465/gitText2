<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
<<<<<<< HEAD
>>>>>>> 19b8a9c (first)
>>>>>>> 8f5179a (first)
>>>>>>> 87a8fdf (first)
>>>>>>> 1e8021d (first)
>>>>>>> 5938de4 (first)
>>>>>>> c55f785 (first)
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>温州医科大学智能监控平台</title>
    <link rel="stylesheet" href="../public/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css"
          href="../public/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css">
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <link rel="stylesheet" href="../assets/css/common.css">
    <link rel="stylesheet" href="../assets/css/navigation.css">
    <link rel="stylesheet" href="../assets/css/tree.css">
    <link rel="stylesheet" href="../assets/css/power_check.css">
    <link rel="stylesheet" href="../assets/css/harmonic.css">
    <script src="../public/jquery/js/jquery-1.10.2.min.js"></script>
    <script src="http://cdn.hcharts.cn/highcharts/highcharts.js"></script>
    <style>
        .el-collapse-item__content {
            padding-bottom: 0;
            margin-bottom: -1px;
        }

        .loop__content {
            padding: 10px;
            /*border-top: 1px solid #ebeef5;*/
            cursor: pointer;
            background: #ECECEC;
            font-size: 14px;
            color: #4A4A4A;
            letter-spacing: 0;
            width: 100%;
            height: 40.6px;
            text-indent: 50px;
        }

        .loop__content:hover, .loop__content-active {
            background: #13B6CC;
            color: #FFFFFF;
        }

        #el-collapse-head-8078.el-collapse-item__header.is-active {
            color: #13B6CC;
        }

        .el-collapse-item__header {
            padding-left: 10px;
        }

        .el-collapse-item__content .el-collapse-item__header {
            background: #FFFFFF;
            font-size: 16px;
            color: #4A4A4A;
            letter-spacing: 0;
            height: 47.2px;
        }

        .el-collapse-item__content.is-active .el-collapse-item__header.is-active {
            color: #13B6CC;
        }

        .el-collapse-item__header {
            text-indent: 40px;
        }

        .has-gutter tr, .el-table th {
            opacity: 0.8;
            background: #384E7C;
            border-radius: 2px;
        }

        .has-gutter .cell {
            font-size: 16px;
            color: #FFFFFF;
            text-align: left;
        }

        .el-table--striped .el-table__body tr.el-table__row--striped td {
            background: #F0F0F0;
        }

        .ele-div .el-icon-arrow-left:before {
            content: "上一页";
        }

        .ele-div .el-icon-arrow-right:before {
            content: "下一页";
            margin: 0;
            width: auto;
        }

        .ele-div .el-pagination.is-background .el-pager li:not(.disabled).active {
            background: #13B6CC;
        }

        .ele-div .el-pagination .btn-prev, .ele-div .el-pagination .btn-next {
            font-size: 12px;
            width: 5em;
            padding: 0em 1em;
            background: #13B6CC;
            color: #FFFFFF;

        }

        .ele-div .el-pagination .btn-prev i, .ele-div .el-pagination .btn-next i {
            font-weight: normal;
        }

        .ele-div .el-pagination {
            text-align: right;
        }

        .ele-div .number {
            font-size: 12px;
            color: #666666 !important;
            font-weight: normal;
        }

        .ele-div .active {
            color: #FFFFFF !important;
        }

        .el-pagination button:disabled {
            background-color: #EFF2F5 !important;
        }

        .dtc-ele-span {
            font-size: 14px;
            color: #414E69;
            float: left;
        }

        .el-collapse {
            border: 0;
        }

        .el-collapse-item__content .el-collapse-item__header {
            margin-left: -5px;
        }

        .el-collapse-item__content  .el-collapse-item__header.is-active{
            color: #13B6CC;
        }
        .dtn-control-label{
            margin-right:5px;
        }
    </style>
</head>
<body style="background-color:#F0F3F8 ">
<div class="dt-title-container dtn-title-container">
    <div class="dt-nav-title dtn-nav-title">温州医科大学智能监控平台</div>
    <div class="dt-nav-logo dtn-nav-logo">
        管理员,&nbsp;&nbsp;你好&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="../assets/img/ic-dropout.png"
                                                             class="dt-nav-quit dtn-nav-quit dtc-com-cur"><span
            class="dt-nav-quit dtc-com-cur dtc-com-mar">退出登录</span>
    </div>
</div>
<div class="dt-nav-container dtn-nav-container">
    <div class="dt-nav-btn active dtn-nav-btn" onclick="javascript:window.location.href='main'">
        <span class="dt-nav-img dt-nav-general dtn-generalization-img"
              style="background: url(../assets/img/ic-overview-gray.png) no-repeat; "></span>
        <span style="cursor:default;" class="dtn-nav-list">概况</span>
    </div>
    <div class="dt-nav-btn dtn-nav-btn  dt-nav-option-active">
        <span class="dt-nav-img dt-nav-monitor dtn-monitor-img"
              style="background: url(../assets/img/ic-transformer-blue.png) no-repeat;"></span>
        <span style="cursor:default;opacity: 1;color: #414E69;" class="dtn-nav-list">变压器监测</span>
        <div class="dtn-item-hr"></div>
    </div>
    <div class="dt-nav-btn dtn-nav-btn" onclick="javascript:window.location.href='harmonic'">
        <span class="dt-nav-img dt-nav-quality dtn-quality-img"></span>
        <span class="dtn-nav-list">电力监测</span>
    </div>

    <div class="dt-nav-btn dtn-nav-btn" onclick="javascript:window.location.href='environment'">
        <span class="dt-nav-img dt-nav-environment dtn-environment-img"></span>
        <span class="dtn-nav-list">环境监测</span>
    </div>
    <!--<div class="dt-nav-btn ">-->
    <!--<span class="dt-nav-img dt-nav-administration"></span>-->
    <!--维护管理-->
    <!--</div>-->
    <div class="dt-nav-btn dtn-nav-btn" onclick="javascript:window.location.href='warning'">
        <span class="dt-nav-img dt-nav-warning dtn-warning-img"></span>
        <span class="dtn-nav-list">报警监测</span>
    </div>
    <div class="dt-nav-btn dtn-nav-btn" onclick="javascript:window.location.href='plan'">
        <span class="dt-nav-img dt-nav-record dtn-record-img"></span>
        <span class="dtn-nav-list">巡察计划</span>
    </div>
</div>
<div class="container-fluid" id="vue-list" v-cloak>
    <div class="row">
        <div class="col-md-2 col-lg-2">
            <div class="dt-left-nav-container">
                <div class="dtn-empty-div"></div>
                <el-collapse @change="handleChange">
                    <div>
                        <el-collapse-item :title="home.home" :name="index" v-for="(home,index) in navList">
                            <div>
                                <el-collapse @change="handleChange">
                                    <el-collapse-item :title="desk.name" v-for="(desk,deskIndex) in home.deskList">
                                        <div v-for="(loop,loopIndex) in desk.loop" class="loop__content"
                                             @click="selectLoop($event,index)">
                                            <span>${loop}</span>
                                        </div>
                                    </el-collapse-item>
                                </el-collapse>
                            </div>
                        </el-collapse-item>
                    </div>
                </el-collapse>
            </div>
        </div>
        <div class="col-md-10 col-lg-10">
            <div class="dt-main-container" style="overflow:hidden;">
                <div class="dt-main-bac dt-harmonic-flex">
                    <div class="dt-main-right" id="dt-main-right" style="width: 100%;">
                        <div class="dt-harmonic-date-select">
                            <div class="form-group form-group-custom dt-harmonic-from-group-custom"
                                 style="margin-left: 20px">
                                <label for="dtp_input" class="control-label dtn-control-label">监测开始时间：</label>
                                <div class="input-group date form_date dt-harmonic-input-group-custom dtn-big-div"
                                     data-date=""
                                     data-date-format="dd MM yyyy" data-link-field="dtp_input"
                                     data-link-format="yyyy-mm-dd"
                                     id="datetimepicker">
                                    <input class="form-control dtn-form-control" size="16" type="text" value="" readonly
                                           id="daycalendarBox">
                                    <span class="input-group-addon dtn-input-group-addon dtn-big-span"
                                          id="calendar"><span
                                            class="glyphicon glyphicon-calendar dtn-span"></span> <img
                                            src="../assets/img/btn_time.png" height="14" width="15"/></span>
                                </div>
                                <input type="hidden" id="dtp_input"/><br/>
                            </div>
                            <div class="form-group form-group-custom dt-harmonic-from-group-custom"
                                 v-show="!isShowData">
                                <label for="dtp_input_end" class="control-label dtn-control-label">监测结束时间：</label>
                                <div class="input-group date form_date_end dt-harmonic-input-group-custom dtn-big-div"
                                     data-date=""
                                     data-date-format="dd MM yyyy" data-link-field="dtp_input_end"
                                     data-link-format="yyyy-mm-dd"
                                     id="datetimepicker_end">
                                    <input class="form-control dtn-form-control" size="16" type="text" value="" readonly
                                           id="daycalendarBox_end">
                                    <!--<span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>-->
                                    <span class="input-group-addon dtn-input-group-addon dtn-big-span"
                                          id="calendar_end"><span
                                            class="glyphicon glyphicon-calendar dtn-span "></span><img
                                            src="../assets/img/btn_time.png" height="14" width="15"/></span>
                                </div>
                                <input type="hidden" id="dtp_input_end"/><br/>
                            </div>
                            <label class="dt-harmonic-power-type dtn-harmonic-power-type"
                                   style="margin-left: 0">类别：</label>
                            <div id="hideDiv">0</div>
                            <select class="dt-harmonic-select dtn-harmonic-select" id="select">
                                <option value="00">A相温度</option>
                                <option value="01">B相温度</option>
                                <option value="02">C相温度</option>
                                <option value="03">A相历史最大温度</option>
                                <option value="04">B相历史最大温度</option>
                                <option value="05">C相历史最大温度</option>
                                <option value="06">风机状态</option>
                            </select>
                            <img src="../assets/img/btn_dropdown.png" alt=""
                                 class="dtn-monitor-img-down" height="6" width="10"/>
                            <div class="dtn-button-div">
                                <button class="middle-button dtn-button-middle dtn-button-search" @click="search"
                                        id="ele-search">查询
                                </button>
                                <button class="middle-button dtn-button-middle dtn-button-outPut" id="outPut"
                                        @click="outPut">导出
                                </button>
                            </div>
                        </div>
                        <div class="dt-harmonic-btn-container">
                            <button class="middle-button dtn-middle-bottons" id="allConfig"
                                    style="left: 0;" @click="showAllConfig">总参数
                            </button>
                            <button class="middle-button  dt-middle-button-position  dtn-middle-bottons" id="chart"
                                    style="left: 91px;" @click="switchChart">图表
                            </button>
                            <button class="middle-button  dt-middle-button-position  dtn-middle-bottons dt-btn-active"
                                    id="data" @click="switchSheet" style="left: 182px">数据
                            </button>

                            <span>
                </span>
                        </div>
                        <div class="dt-harmonic-sheet" id="sheetContainer" style="display: none">
                            <div class="table-responsive table-responsive-custom" style="display: none">
                                <table class="table table-striped table-custom" id="outPutTable"
                                >
                                    <thead class="main-box-top">
                                    <tr>
                                        <th>回路名称</th>
                                        <th>采集时间</th>
                                        <th>数据</th>
                                        <th>回路名称</th>
                                        <th>采集时间</th>
                                        <th>数据</th>
                                    </tr>
                                    </thead>
                                    <tr v-for="data in list">
                                        <th>${loop}</th>
                                        <th>${data.ST1}</th>
                                        <th>${data.DT1 | switchFilter}</th>

                                        <th>${loop}</th>
                                        <th>${data.ST2}</th>
                                        <th>${data.DT2 | switchFilter}</th>

                                    </tr>

                                </table>

                            </div>
                        </div>

                        <!--数据-->
                        <div v-show="isShowData" class="ele-div">

                            <div class="block" style="padding: 20px 20px 10px 20px;background-color: white">
                                <div class="container_table">
                                    <el-table
                                            :data="tableData.slice((currentPage-1)*pagesize,currentPage*pagesize)"
                                            stripe
                                            style="width: 100%"
                                            :default-sort="{prop: 'date', order: 'descending'}"
                                    >
                                        <el-table-column
                                                prop="loop"
                                                label="回路名称"

                                                width="180">
                                        </el-table-column>
                                        <el-table-column
                                                prop="DT1"
                                                label="采集时间"
                                                width="180">
                                        </el-table-column>
                                        <el-table-column
                                                prop="ST1"

                                                label="数据">
                                        </el-table-column>
                                        <el-table-column
                                                prop="loop"

                                                label="回路名称">
                                        </el-table-column>
                                        <el-table-column
                                                prop="DT2"
                                                label="采集时间">
                                        </el-table-column>
                                        <el-table-column
                                                prop="ST2"

                                                label="数据">
                                        </el-table-column>

                                    </el-table>
                                    <div style="margin-top: 10px"><span
                                            class="dtc-ele-span">共<span>${total}</span>条</span>
                                        <el-pagination layout="prev, pager, next" @current-change="current_change"
                                                       :total="total"
                                                       background
                                        >
                                        </el-pagination>
                                    </div>
                                </div>

                            </div>
                        </div>

                        <div class="dtn-harmonic-big" v-show="isShowAllConfig">
                            <div class="dtn-harmonic-allConfig">

                                <div class="dtn-harmonic-small-div">
                                    <div style="float: left;vertical-align: middle">
                                        <img src="../assets/img/ic_transformer_temperature.png" height="77" width="70"
                                             class="dtn-allConfig-img"/></div>
                                    <div style="float: left">
                                        <div class="dtn-allConfig-p">A箱温度<span class="dtn-allConfig-span ">${AllConfig.TS | floatFix}°C</span>
                                        </div>
                                        <p class="dtn-allConfig-p">B箱温度<span class="dtn-allConfig-span ">${AllConfig.TS1 | floatFix}°C</span>
                                        </p>
                                        <p class="dtn-allConfig-p">C箱温度<span class="dtn-allConfig-span ">${AllConfig.TS2 | floatFix}°C</span>
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="dtn-harmonic-allConfig" style="margin-left: 2%">
                                <div class="dtn-harmonic-small-div">
                                    <div style="float: left;vertical-align: middle">
                                        <img src="../assets/img/ic_transformer_temperature.png" height="77" width="70"
                                             class="dtn-allConfig-img"/></div>
                                    <div style="float: left">
                                        <p class="dtn-allConfig-p">A箱历史最大温度<span
                                                class="dtn-allConfig-span dtn-allConfig-span-right">${AllConfig.TS3 | floatFix}°C</span>
                                        </p>
                                        <p class="dtn-allConfig-p">B箱历史最大温度<span
                                                class="dtn-allConfig-span dtn-allConfig-span-right">${AllConfig.DT4 | floatFix}°C</span>
                                        </p>
                                        <p class="dtn-allConfig-p">C箱历史最大温度<span
                                                class="dtn-allConfig-span dtn-allConfig-span-right">${AllConfig.DT5 | floatFix}°C</span>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div style=" border: solid 1px #ddd" id="chartContainer">
                            <div id="container" style="min-width:400px;height:415px;"></div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="dtn-footer">
                版本所有：温州医科大学&nbsp;地址：浙江省温州茶山高教园区
            </div>
        </div>

    </div>
</div>

<script type="text/javascript" src="../public/jquery/js/jquery-1.10.2.min.js"></script>
<script type="text/javascript" src="../public/bootstrap/js/bootstrap.min.js"></script>
<script src="../public/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
<script src="../public/bootstrap-datetimepicker/js/bootstrap-datetimepicker.zh-CN.js"></script>
<script src="../public/FileSaver/FileSaver.min.js"></script>
<script src="../public/js-xlsx/xlsx.core.min.js"></script>
<script type="text/javascript" src="../public/tableExport.min.js"></script>
<script src="https://cdn.bootcss.com/axios/0.18.0/axios.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.js"></script>
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<script src="https://cdn.bootcss.com/underscore.js/1.9.0/underscore-min.js"></script>
<script src="../public/file/filesaver.js"></script>
<script src="../public/helper/dt-epo-helpers.js"></script>
<script>

    $(document).ready(function () {

        var startDate = new Date();
        startDate.setFullYear(2018, 6, 1);
        var endDate = new Date();
        endDate.setFullYear(2018, 6, 31);
        $('#daycalendarBox').val(new Date().Format("yyyy-MM-dd"));
        $('#daycalendarBox_end').val(new Date().Format("yyyy-MM-dd"));
        $('.form_date').datetimepicker({
            language: 'zh-CN',
            format: 'yyyy-mm-dd',
            weekStart: 1,
            todayBtn: 1,
            autoclose: 1,
            todayHighlight: 1,
            startView: 2,
            minView: 2,
            forceParse: 0,
//            startDate: startDate,
//            endDate: endDate
        });
        $('.form_date_end').datetimepicker({
            language: 'zh-CN',
            format: 'yyyy-mm-dd',
            weekStart: 1,
            todayBtn: 1,
            autoclose: 1,
            todayHighlight: 1,
            startView: 2,
            minView: 2,
            forceParse: 0,
//            startDate: startDate,
//            endDate: endDate
        });

        function logOut() {
            sessionStorage.removeItem('user');
            sessionStorage.removeItem('isLogin');
            window.location.href = 'index';
        }

        $('.dt-nav-quit').click(function () {
            logOut();
        });

        $('#chartContainer').hide();
    });


    const navMessage = {
        navMessage: [{
            "home": "图书馆",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        }, {
            "home": "同仁楼",
            "deskList": [{
                "name": "I段进线变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "同德楼",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        }, {
            "home": "同济楼",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        }, {
            "home": "学生活动中心",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "一期宿舍",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器", "Ⅲ段进线变压器"]
            }]
        }, {
            "home": "二期宿舍",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器", "Ⅲ段进线变压器"]
            }]
        }, {
            "home": "中试基地",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "学院路2#",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "求是楼",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        }, {
            "home": "三期宿舍食堂",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器", "Ⅲ段进线变压器", "Ⅳ段进线变压器", "Ⅴ段进线变压器"]
            }]
        }, {
            "home": "学院路1#",
            "deskList": [{
                "name": "变压器",
                "loop": ["1号变压器8176", "2号变压器8176", "3号变压器288线", "4号变压器288线"]
            }]
        }]
    };


    Date.prototype.Format = function (fmt) { //author: meizz
        var o = {
            "M+": this.getMonth() + 1, //月份
            "d+": this.getDate(), //日
            "h+": this.getHours(), //小时
            "m+": this.getMinutes(), //分
            "s+": this.getSeconds(), //秒
            "q+": Math.floor((this.getMonth() + 3) / 3), //季度
            "S": this.getMilliseconds() //毫秒
        };
        if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
        for (var k in o)
            if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
        return fmt;
    };
    //第一次加载页面，默认渲染图书馆的二级导航栏
    //    $(document).ready(function () {
    //        renderSecondNav("图书馆");
    //        $('#chartContainer').hide();
    //        //$('#dtp_input').val(new Date().Format("yyyy-MM-dd"));
    //        $('#daycalendarBox').val(new Date().Format("yyyy-MM-dd"));
    //    });
    //请求数据
    function getPowerData(obj, index, def) {
        const loading = obj.$loading({
            lock: true,
            text: '查找数据中',
            spinner: 'el-icon-loading',
            background: 'rgba(0, 0, 0, 0.7)'
        });
        //console.log("executed");
        console.log(obj.isShowData);
        if (obj.isShowData) {
            var Time1 = $('#daycalendarBox').val() + ' 00:00:00';
            var Time2 = $('#daycalendarBox').val() + ' 23:59:59';
        } else {
            Time1 = $('#daycalendarBox').val() + ' 00:00:00';
            Time2 = $('#daycalendarBox_end').val() + ' 23:59:59';
        }
        var loopName = $('.loop__content-active').find("span").html();
        var keyObj = keySwitch(loopName, navMessage.navMessage[index].home);
        var typeKey = $("#select").val();
        var homeKey = StringNum(index);
        var key = "";
        //console.log($('.dt-left-nav-box-active').html().toString());
        key = homeKey + keyObj.loopKey + typeKey;
        if (def) {
            key = def.key;
            Time1 = def.Time;
            Time2 = def.Time;
            homeKey = def.homeKey;
        }
        var
            API_STATUS = {
                "apicode": "ElemonitorInfo",
                "args": {
                    "time1": Time1,
                    "time2": Time2,
                    "key": key,
                    "home": homeKey
                }
            };
        axios.post("/api", API_STATUS
            , {
                headers: {
                    'Content-Type': 'application/json'
                }
            }).then(function (res) {
            loading.close();
            if (res.data.obj.length > 0) {
                obj.remainder = res.data.obj[0].TS1;
                obj.loop = $('.loop__content-active span').html();
                var len = res.data.obj.length;
                var prop = [];
                var pop = {};
                for (var j = 0; j < len / 2; j++) {
                    pop = {
                        loop: obj.loop,
                        ST1: res.data.obj[j * 2].TS,
                        DT1: res.data.obj[j * 2].DT,
                        ST2: res.data.obj[j * 2 + 1].TS,
                        DT2: res.data.obj[j * 2 + 1].DT,
                    }
                    prop[j] = pop;
                }
                vm.total = j;
                obj.tableData = prop;
                renderChart(res.data.obj);
            } else {
                loading.close();
                obj.$message.error('暂无当前数据');
                obj.tableData = [];
                console.log('no data');
            }
        }).catch(function (error) {
            console.log(error);
        });

    }


    //渲染二级导航栏(abandon)
    function renderSecondNav(mainNav) {
        var navList = getSecondNav(mainNav);
        var headBegin = ' <div class="dt-tree-node-header"> <span class="glyphicon glyphicon-minus node" aria-hidden="true" style="color: black;"></span> <span class="dt-tree-node-header-font">';
        var headEnd = '</span> </div>';
        var bodyBegin = '<div class="dt-tree-node-container-show"> <div class="dt-tree-node-header dt-tree-node-position"> <span class="dt-tree-node-header-font" style="padding-left:20px; ">';
        var bodyEnd = '</span> </div> <div class="dt-tree-node-container-show"></div> </div>';
        $(".dt-tree-view").html("");
        for (var i = 0; i < navList.length; i++) {
            $(".dt-tree-view").append(headBegin + navList[i].name + headEnd);
            for (var j = 0; j < navList[i].loop.length; j++) {
                $(".dt-tree-view").append(bodyBegin + navList[i].loop[j] + bodyEnd);
            }
        }

        $('.dt-tree-node-header:eq(1)').addClass('dt-tree-node-header-active');

        $('.dt-tree-node-container-show .dt-tree-node-header').click(function () {
            $('.dt-tree-node-header-active').removeClass('dt-tree-node-header-active');
            $(this).addClass('dt-tree-node-header-active');
            getPowerData(vm);
            //console.log("lxy");
        });


    }

    var vm = new Vue({
        el: "#vue-list",
        delimiters: ['${', '}'],
        data: {
            list: [],
            AllConfig: {},
            loop: "I进线",
            remainder: 0,
            fullscreenLoading: false,
            navList: navMessage.navMessage,
            isShowAllConfig: false,
            // 数据页面
            isShowData: false,
            total: 0,//默认数据总数
            pagesize: 11,//每页的数据条数
            currentPage: 1,//默认开始页面
            istag: true,
            tableData: []
        },
        methods: {
            // 数据页面
            tableRowClassName({row, rowIndex}) {
                if (rowIndex === 0) {
                    return 'th';
                }
                return '';
            },
            switchChange() {
                this.istag = !this.istag;

            },
            created: function () {
                this.total = this.tableData.length;
            },
            current_change: function (currentPage) {
                this.currentPage = currentPage;
            },

            // end
            getGetEleMonitorList: function (obj, index) {
                const loading = obj.$loading({
                    lock: true,
                    text: '查找数据中',
                    spinner: 'el-icon-loading',
                    background: 'rgba(0, 0, 0, 0.7)'
                });
                //console.log("executed");
                var Time = $('#daycalendarBox').val();
                var loopName = $('.loop__content-active').find("span").html();
                var keyObj = keySwitch(loopName, navMessage.navMessage[index].home);
                var typeKey = $("#select").val();
                var homeKey = StringNum(index);
                var key = homeKey + keyObj.loopKey + '00';

                //console.log($('.dt-left-nav-box-active').html().toString());
                for (var i = 1; i < 7; i++) {
                    key += (',' + homeKey + keyObj.loopKey + '0' + i.toString());
                }
                var
                    API_STATUS = {
                        "apicode": "GetEleMonitorList",
                        "args": {
                            "key": key,
                            "home": homeKey
                        }
                    };
                axios.post("/api", API_STATUS
                    , {
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    }).then(function (res) {
                    console.log(res.data.obj.data);
                    loading.close();
                    if (res.data.obj.data) {
                        obj.AllConfig = res.data.obj.data;
                    } else {
                        loading.close();
                        obj.$message.error('暂无当前数据');
                        obj.AllConfig = [];
                        console.log('no data');
                    }
                }).catch(function (error) {
                    console.log(error);

                });
            },

            selectLoop: function (obj, index) {
                var _this = this;
                $('.loop__content-active').removeClass("loop__content-active");
                var el = obj.currentTarget;
                $(el).addClass("loop__content-active");
                console.log($(el));
                if (_this.isShowAllConfig) {
                    _this.getGetEleMonitorList(_this, index);
                } else {
                    getPowerData(_this, index);
                }
                sessionStorage.setItem('homeIndex', index);
            },
            search: function () {
                var _this = this;
                var index = sessionStorage.getItem('homeIndex');
                if (index == null) {
                    _this.$message.error("请选择地点");
                    return;
                }
                if (_this.isShowAllConfig) {
                    _this.showAllConfig();
                } else {
                    getPowerData(_this, index);
                }
            },
            switchChart: function () {
                var _this = this;
                _this.isShowAllConfig = false;
                _this.isShowData = false;
                $('#sheetContainer').hide();
                $('#chartContainer').show();
                $(".middle-button").removeClass('dt-btn-active');
                $("#chart").addClass('dt-btn-active');
                var index = sessionStorage.getItem('homeIndex');
                if (index === null) {
                    _this.$message.error('请选择地点');
                    console.log('no home');
                    return;
                }
                renderChart(this.list);
                $('#ele-search').click();
            },
            switchSheet: function () {
                var _this = this;
                var index = sessionStorage.getItem('homeIndex');

                _this.isShowAllConfig = false;
                _this.isShowData = true;

                $('#chartContainer').hide();
                $('#sheetContainer').show();
                $(".middle-button").removeClass('dt-btn-active');
                $("#data").addClass('dt-btn-active');
                if (index === null) {
                    _this.$message.error('请选择地点');
                    console.log('no home');
                    return;
                }
                getPowerData(_this, index);
            },
            handleChange: function (val) {
                console.log(val);
            },
            outPut: function () {
                // $('#outPutTable').tableExport({type: 'excel'}); if (obj.isShowData) {
                var obj = this;
                var index = sessionStorage.getItem('homeIndex');
                const loading = obj.$loading({
                    lock: true,
                    text: '查找数据中',
                    spinner: 'el-icon-loading',
                    background: 'rgba(0, 0, 0, 0.7)'
                });
                if (obj.isShowData) {
                    var Time1 = $('#daycalendarBox').val() + ' 00:00:00';
                    var Time2 = $('#daycalendarBox').val() + ' 23:59:59';
                } else {
                    Time1 = $('#daycalendarBox').val() + ' 00:00:00';
                    Time2 = $('#daycalendarBox_end').val() + ' 23:59:59';
                }
                var loopName = $('.loop__content-active').find("span").html();
                var keyObj = keySwitch(loopName, navMessage.navMessage[index].home);
                var typeKey = $("#select").val();
                var homeKey = StringNum(index);
                var key = "";
                key = homeKey + keyObj.loopKey + typeKey;
                obj.loop = $('.loop__content-active span').html();
                // if () 
                var API_STATUS = {
                    "apicode": "exportMonitorExcel",
                    "args": {
                        "time1": Time1,
                        "time2": Time2,
                        "key": key,
                        "home": homeKey
                    }
                };
                axios.post("/api", API_STATUS, {
                    headers: {
                        'Content-Type': 'application/json'
                    }
                }).then(function (res) {
                    loading.close();
                    if (res.data.obj.blob!=null){
                    var data = res.data.obj.blob;      //要还原成二进制的文件数据

                    var arrBuffer = new ArrayBuffer(data.length);
                    var view = new Uint8Array(arrBuffer);

                    for (var i = 0; i < data.length; i++) {
                        view[i] = data.charCodeAt(i);
                    }
                    var fileName =obj.loop+'.xlsx';
                    var blob = new Blob([arrBuffer], {type: 'application/octet-stream'});
                    saveAs(blob, fileName);
                }
                else{
                  obj.$message.error("暂无当前数据");
                }})

            },
            showAllConfig: function () {
                var _this = this;
                var index = sessionStorage.getItem('homeIndex');
                $('#chartContainer').hide();
                $('#sheetContainer').show();
                $(".middle-button").removeClass('dt-btn-active');
                $("#allConfig").addClass('dt-btn-active');
                _this.isShowAllConfig = true;
                _this.isShowData = false;
                if (index === null) {
                    _this.$message.error('请选择地点');
                    console.log('no home');
                    return;
                }
                _this.getGetEleMonitorList(_this, index);

            }
        },
        filters: {
            switchFilter: function (value) {
                var str = $('select option:selected').html().toString();
                if (str === '风机状态') {
                    value = parseInt(value);
                    if (value === 1) {
                        return '启动'
                    } else if (value === 0) {
                        return '停止'
                    } else {
                        return 'error'
                    }
                } else {
                    return value;
                }
            },

            floatFix: function (value) {
                if (value || value === 0) {
                    value = parseFloat(value);
                    value = Math.round(value * 1000) / 1000;
                    return value;
                } else {
                    return "暂无数据";
                }
            }

        },
        created: function () {
            var isLogin = sessionStorage.getItem('isLogin') || false;
            if (!isLogin) {
                window.location.href = 'index';
            }
            this.showAllConfig();
//            getPowerData(this, {
//                "key": "0000000",
//                "homeKey": "00",
//                "time": "2018-07-01"
//            });
        },
    });


    //切换二级导航栏
    $('.dt-left-nav-box').click(function () {
        $('.dt-left-nav-box-active').removeClass('dt-left-nav-box-active');
        $(this).addClass('dt-left-nav-box-active');
        var home = $(this).html().toString();
        $('.home').html(home);
        renderSecondNav(home);
        getPowerData(vm);
        renderChart(vm);
    });

    function renderChart(obj) {
        var data = [];
        var time = [];
        for (var i = 0; i < obj.length; i++) {
            data.push(obj[i].TS);
        }
        for (i = 0; i < obj.length; i++) {
            time.push(obj[i].DT.toString().substr(10, 6));
        }
        for (var i = 0; i < data.length; i++) {
            data[i] = parseFloat(data[i]);
        }

        var chart = Highcharts.chart('chartContainer', {
            chart: {
                // backgroundColor:'red',
                type: 'areaspline',
                zoomType: 'x',
                panning: true,
                panKey: 'shift',
                style: {
                    fontFamily: "",
                    fontSize: '14px',
                    fontWeight: 'bold',
                    color: '#414E69',
                },
                spacingTop: 50,
            },
            legend: {
                // layout: 'vertical',
                backgroundColor: '#FFFFFF',
                floating: true,
                align: 'center',
                verticalAlign: 'top',
                y: -7,
                backgroundColor: 'transparent',
                symbolHeight: 10,
                itemStyle: {
                    fontSize: '16px',
                    color: '#414E69',
                }
                //labelFormat: '<span style="{color}">{name} (click to hide or show)</span>'
            },
            credits: {
                enabled: false
            },
            title: {
                text: $('select option:selected').html(),
                style: {
                    color: '#ffffff',
                    fontSize: '18px'
                },
                margin: 50
            },
            subtitle: {
                text: '选择区域放大，按住shift拖动鼠标平移',
                floating: false,
            },
            lang: {
                resetZoom: '还原图表',
                resetZoomTitle: '还原图表为1:1大小'
            },
            xAxis: {
                categories: time
            },
            yAxis: {
                title: {
                    text: $('select option:selected').html()
                },
                labels: {
                    formatter: function () {
                        return this.value;
                    },
                    style: {
                        fontSize: '14px',
                        color: ' #414E69'
                    }
                }
            },
            tooltip: {
                crosshairs: true,
                shared: true
            },
            plotOptions: {
                areaspline: {
                    color: '#FF3E3E',
                    lineColor: '#FF3E3E',
                    fillOpacity: 0.2
                }
            },
            scrollbar: {
                enabled: true
            },
            series: [{
                name: $('select option:selected').html(),
                data: data,
                marker: {//线上数据点
                    radius: 3,
                    lineWidth: 1,
                    lineColor: '#FF3E3E',
                    fillColor: '#FF3E3E',
                    states: {
                        hover: {
                            enabled: true
                        }
                    }
                },
                fillColor: {
                    linearGradient: {
                        x1: 0,
                        y1: 0,
                        x2: 0,
                        y2: 1
                    },
                    stops: [
                        [0, '#FF893B'],
                        [1, 'rgba(253,177,126,0.33)']
                    ]
                }
            }]
        });
    }


    //挑选二级导航栏的内容
    function getSecondNav(home) {
        var navMessage = [{
            "home": "图书馆",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        }, {
            "home": "同仁楼",
            "deskList": [{
                "name": "I段进线变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "同德楼",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        }, {
            "home": "同济楼",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        }, {
            "home": "学生活动中心",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "一期宿舍",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器", "Ⅲ段进线变压器"]
            }]
        }, {
            "home": "二期宿舍",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器", "Ⅲ段进线变压器"]
            }]
        }, {
            "home": "中试基地",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "学院路2#",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "求是楼",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        }, {
            "home": "三期宿舍食堂",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器", "Ⅲ段进线变压器", "Ⅳ段进线变压器", "Ⅴ段进线变压器"]
            }]
        }, {
            "home": "学院路1#",
            "deskList": [{
                "name": "变压器",
                "loop": ["1号变压器8176", "2号变压器8176", "3号变压器288线", "4号变压器288线"]
            }]
        }];

        var navList = [];

        for (var i = 0; i < navMessage.length; i++) {
            if (home === navMessage[i].home)
                navList = navMessage[i].deskList;
        }
        return navList;

    }

</script>
</body>
<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
=======
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>温州医科大学智能监控平台</title>
    <link rel="stylesheet" href="../public/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css"
          href="../public/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css">
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <link rel="stylesheet" href="../assets/css/common.css">
    <link rel="stylesheet" href="../assets/css/navigation.css">
    <link rel="stylesheet" href="../assets/css/tree.css">
    <link rel="stylesheet" href="../assets/css/power_check.css">
    <link rel="stylesheet" href="../assets/css/harmonic.css">
    <script src="../public/jquery/js/jquery-1.10.2.min.js"></script>
    <script src="http://cdn.hcharts.cn/highcharts/highcharts.js"></script>
    <style>
        .el-collapse-item__content {
            padding-bottom: 0;
            margin-bottom: -1px;
        }

        .loop__content {
            padding: 10px;
            /*border-top: 1px solid #ebeef5;*/
            cursor: pointer;
            background: #ECECEC;
            font-size: 14px;
            color: #4A4A4A;
            letter-spacing: 0;
            width: 100%;
            height: 40.6px;
            text-indent: 50px;
        }

        .loop__content:hover, .loop__content-active {
            background: #13B6CC;
            color: #FFFFFF;
        }

        #el-collapse-head-8078.el-collapse-item__header.is-active {
            color: #13B6CC;
        }

        .el-collapse-item__header {
            padding-left: 10px;
        }

        .el-collapse-item__content .el-collapse-item__header {
            background: #FFFFFF;
            font-size: 16px;
            color: #4A4A4A;
            letter-spacing: 0;
            height: 47.2px;
        }

        .el-collapse-item__content.is-active .el-collapse-item__header.is-active {
            color: #13B6CC;
        }

        .el-collapse-item__header {
            text-indent: 40px;
        }

        .has-gutter tr, .el-table th {
            opacity: 0.8;
            background: #384E7C;
            border-radius: 2px;
        }

        .has-gutter .cell {
            font-size: 16px;
            color: #FFFFFF;
            text-align: left;
        }

        .el-table--striped .el-table__body tr.el-table__row--striped td {
            background: #F0F0F0;
        }

        .ele-div .el-icon-arrow-left:before {
            content: "上一页";
        }

        .ele-div .el-icon-arrow-right:before {
            content: "下一页";
            margin: 0;
            width: auto;
        }

        .ele-div .el-pagination.is-background .el-pager li:not(.disabled).active {
            background: #13B6CC;
        }

        .ele-div .el-pagination .btn-prev, .ele-div .el-pagination .btn-next {
            font-size: 12px;
            width: 5em;
            padding: 0em 1em;
            background: #13B6CC;
            color: #FFFFFF;

        }

        .ele-div .el-pagination .btn-prev i, .ele-div .el-pagination .btn-next i {
            font-weight: normal;
        }

        .ele-div .el-pagination {
            text-align: right;
        }

        .ele-div .number {
            font-size: 12px;
            color: #666666 !important;
            font-weight: normal;
        }

        .ele-div .active {
            color: #FFFFFF !important;
        }

        .el-pagination button:disabled {
            background-color: #EFF2F5 !important;
        }

        .dtc-ele-span {
            font-size: 14px;
            color: #414E69;
            float: left;
        }

        .el-collapse {
            border: 0;
        }

        .el-collapse-item__content .el-collapse-item__header {
            margin-left: -5px;
        }

        .el-collapse-item__content  .el-collapse-item__header.is-active{
            color: #13B6CC;
        }
        .dtn-control-label{
            margin-right:5px;
        }
    </style>
</head>
<body style="background-color:#F0F3F8 ">
<div class="dt-title-container dtn-title-container">
    <div class="dt-nav-title dtn-nav-title">温州医科大学智能监控平台</div>
    <div class="dt-nav-logo dtn-nav-logo">
        管理员,&nbsp;&nbsp;你好&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="../assets/img/ic-dropout.png"
                                                             class="dt-nav-quit dtn-nav-quit dtc-com-cur"><span
            class="dt-nav-quit dtc-com-cur dtc-com-mar">退出登录</span>
    </div>
</div>
<div class="dt-nav-container dtn-nav-container">
    <div class="dt-nav-btn active dtn-nav-btn" onclick="javascript:window.location.href='main'">
        <span class="dt-nav-img dt-nav-general dtn-generalization-img"
              style="background: url(../assets/img/ic-overview-gray.png) no-repeat; "></span>
        <span style="cursor:default;" class="dtn-nav-list">概况</span>
    </div>
    <div class="dt-nav-btn dtn-nav-btn  dt-nav-option-active">
        <span class="dt-nav-img dt-nav-monitor dtn-monitor-img"
              style="background: url(../assets/img/ic-transformer-blue.png) no-repeat;"></span>
        <span style="cursor:default;opacity: 1;color: #414E69;" class="dtn-nav-list">变压器监测</span>
        <div class="dtn-item-hr"></div>
    </div>
    <div class="dt-nav-btn dtn-nav-btn" onclick="javascript:window.location.href='harmonic'">
        <span class="dt-nav-img dt-nav-quality dtn-quality-img"></span>
        <span class="dtn-nav-list">电力监测</span>
    </div>

    <div class="dt-nav-btn dtn-nav-btn" onclick="javascript:window.location.href='environment'">
        <span class="dt-nav-img dt-nav-environment dtn-environment-img"></span>
        <span class="dtn-nav-list">环境监测</span>
    </div>
    <!--<div class="dt-nav-btn ">-->
    <!--<span class="dt-nav-img dt-nav-administration"></span>-->
    <!--维护管理-->
    <!--</div>-->
    <div class="dt-nav-btn dtn-nav-btn" onclick="javascript:window.location.href='warning'">
        <span class="dt-nav-img dt-nav-warning dtn-warning-img"></span>
        <span class="dtn-nav-list">报警监测</span>
    </div>
    <div class="dt-nav-btn dtn-nav-btn" onclick="javascript:window.location.href='plan'">
        <span class="dt-nav-img dt-nav-record dtn-record-img"></span>
        <span class="dtn-nav-list">巡察计划</span>
    </div>
</div>
<div class="container-fluid" id="vue-list" v-cloak>
    <div class="row">
        <div class="col-md-2 col-lg-2">
            <div class="dt-left-nav-container">
                <div class="dtn-empty-div"></div>
                <el-collapse @change="handleChange">
                    <div>
                        <el-collapse-item :title="home.home" :name="index" v-for="(home,index) in navList">
                            <div>
                                <el-collapse @change="handleChange">
                                    <el-collapse-item :title="desk.name" v-for="(desk,deskIndex) in home.deskList">
                                        <div v-for="(loop,loopIndex) in desk.loop" class="loop__content"
                                             @click="selectLoop($event,index)">
                                            <span>${loop}</span>
                                        </div>
                                    </el-collapse-item>
                                </el-collapse>
                            </div>
                        </el-collapse-item>
                    </div>
                </el-collapse>
            </div>
        </div>
        <div class="col-md-10 col-lg-10">
            <div class="dt-main-container" style="overflow:hidden;">
                <div class="dt-main-bac dt-harmonic-flex">
                    <div class="dt-main-right" id="dt-main-right" style="width: 100%;">
                        <div class="dt-harmonic-date-select">
                            <div class="form-group form-group-custom dt-harmonic-from-group-custom"
                                 style="margin-left: 20px">
                                <label for="dtp_input" class="control-label dtn-control-label">监测开始时间：</label>
                                <div class="input-group date form_date dt-harmonic-input-group-custom dtn-big-div"
                                     data-date=""
                                     data-date-format="dd MM yyyy" data-link-field="dtp_input"
                                     data-link-format="yyyy-mm-dd"
                                     id="datetimepicker">
                                    <input class="form-control dtn-form-control" size="16" type="text" value="" readonly
                                           id="daycalendarBox">
                                    <span class="input-group-addon dtn-input-group-addon dtn-big-span"
                                          id="calendar"><span
                                            class="glyphicon glyphicon-calendar dtn-span"></span> <img
                                            src="../assets/img/btn_time.png" height="14" width="15"/></span>
                                </div>
                                <input type="hidden" id="dtp_input"/><br/>
                            </div>
                            <div class="form-group form-group-custom dt-harmonic-from-group-custom"
                                 v-show="!isShowData">
                                <label for="dtp_input_end" class="control-label dtn-control-label">监测结束时间：</label>
                                <div class="input-group date form_date_end dt-harmonic-input-group-custom dtn-big-div"
                                     data-date=""
                                     data-date-format="dd MM yyyy" data-link-field="dtp_input_end"
                                     data-link-format="yyyy-mm-dd"
                                     id="datetimepicker_end">
                                    <input class="form-control dtn-form-control" size="16" type="text" value="" readonly
                                           id="daycalendarBox_end">
                                    <!--<span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>-->
                                    <span class="input-group-addon dtn-input-group-addon dtn-big-span"
                                          id="calendar_end"><span
                                            class="glyphicon glyphicon-calendar dtn-span "></span><img
                                            src="../assets/img/btn_time.png" height="14" width="15"/></span>
                                </div>
                                <input type="hidden" id="dtp_input_end"/><br/>
                            </div>
                            <label class="dt-harmonic-power-type dtn-harmonic-power-type"
                                   style="margin-left: 0">类别：</label>
                            <div id="hideDiv">0</div>
                            <select class="dt-harmonic-select dtn-harmonic-select" id="select">
                                <option value="00">A相温度</option>
                                <option value="01">B相温度</option>
                                <option value="02">C相温度</option>
                                <option value="03">A相历史最大温度</option>
                                <option value="04">B相历史最大温度</option>
                                <option value="05">C相历史最大温度</option>
                                <option value="06">风机状态</option>
                            </select>
                            <img src="../assets/img/btn_dropdown.png" alt=""
                                 class="dtn-monitor-img-down" height="6" width="10"/>
                            <div class="dtn-button-div">
                                <button class="middle-button dtn-button-middle dtn-button-search" @click="search"
                                        id="ele-search">查询
                                </button>
                                <button class="middle-button dtn-button-middle dtn-button-outPut" id="outPut"
                                        @click="outPut">导出
                                </button>
                            </div>
                        </div>
                        <div class="dt-harmonic-btn-container">
                            <button class="middle-button dtn-middle-bottons" id="allConfig"
                                    style="left: 0;" @click="showAllConfig">总参数
                            </button>
                            <button class="middle-button  dt-middle-button-position  dtn-middle-bottons" id="chart"
                                    style="left: 91px;" @click="switchChart">图表
                            </button>
                            <button class="middle-button  dt-middle-button-position  dtn-middle-bottons dt-btn-active"
                                    id="data" @click="switchSheet" style="left: 182px">数据
                            </button>

                            <span>
                </span>
                        </div>
                        <div class="dt-harmonic-sheet" id="sheetContainer" style="display: none">
                            <div class="table-responsive table-responsive-custom" style="display: none">
                                <table class="table table-striped table-custom" id="outPutTable"
                                >
                                    <thead class="main-box-top">
                                    <tr>
                                        <th>回路名称</th>
                                        <th>采集时间</th>
                                        <th>数据</th>
                                        <th>回路名称</th>
                                        <th>采集时间</th>
                                        <th>数据</th>
                                    </tr>
                                    </thead>
                                    <tr v-for="data in list">
                                        <th>${loop}</th>
                                        <th>${data.ST1}</th>
                                        <th>${data.DT1 | switchFilter}</th>

                                        <th>${loop}</th>
                                        <th>${data.ST2}</th>
                                        <th>${data.DT2 | switchFilter}</th>

                                    </tr>

                                </table>

                            </div>
                        </div>

                        <!--数据-->
                        <div v-show="isShowData" class="ele-div">

                            <div class="block" style="padding: 20px 20px 10px 20px;background-color: white">
                                <div class="container_table">
                                    <el-table
                                            :data="tableData.slice((currentPage-1)*pagesize,currentPage*pagesize)"
                                            stripe
                                            style="width: 100%"
                                            :default-sort="{prop: 'date', order: 'descending'}"
                                    >
                                        <el-table-column
                                                prop="loop"
                                                label="回路名称"

                                                width="180">
                                        </el-table-column>
                                        <el-table-column
                                                prop="DT1"
                                                label="采集时间"
                                                width="180">
                                        </el-table-column>
                                        <el-table-column
                                                prop="ST1"

                                                label="数据">
                                        </el-table-column>
                                        <el-table-column
                                                prop="loop"

                                                label="回路名称">
                                        </el-table-column>
                                        <el-table-column
                                                prop="DT2"
                                                label="采集时间">
                                        </el-table-column>
                                        <el-table-column
                                                prop="ST2"

                                                label="数据">
                                        </el-table-column>

                                    </el-table>
                                    <div style="margin-top: 10px"><span
                                            class="dtc-ele-span">共<span>${total}</span>条</span>
                                        <el-pagination layout="prev, pager, next" @current-change="current_change"
                                                       :total="total"
                                                       background
                                        >
                                        </el-pagination>
                                    </div>
                                </div>

                            </div>
                        </div>

                        <div class="dtn-harmonic-big" v-show="isShowAllConfig">
                            <div class="dtn-harmonic-allConfig">

                                <div class="dtn-harmonic-small-div">
                                    <div style="float: left;vertical-align: middle">
                                        <img src="../assets/img/ic_transformer_temperature.png" height="77" width="70"
                                             class="dtn-allConfig-img"/></div>
                                    <div style="float: left">
                                        <div class="dtn-allConfig-p">A箱温度<span class="dtn-allConfig-span ">${AllConfig.TS | floatFix}°C</span>
                                        </div>
                                        <p class="dtn-allConfig-p">B箱温度<span class="dtn-allConfig-span ">${AllConfig.TS1 | floatFix}°C</span>
                                        </p>
                                        <p class="dtn-allConfig-p">C箱温度<span class="dtn-allConfig-span ">${AllConfig.TS2 | floatFix}°C</span>
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="dtn-harmonic-allConfig" style="margin-left: 2%">
                                <div class="dtn-harmonic-small-div">
                                    <div style="float: left;vertical-align: middle">
                                        <img src="../assets/img/ic_transformer_temperature.png" height="77" width="70"
                                             class="dtn-allConfig-img"/></div>
                                    <div style="float: left">
                                        <p class="dtn-allConfig-p">A箱历史最大温度<span
                                                class="dtn-allConfig-span dtn-allConfig-span-right">${AllConfig.TS3 | floatFix}°C</span>
                                        </p>
                                        <p class="dtn-allConfig-p">B箱历史最大温度<span
                                                class="dtn-allConfig-span dtn-allConfig-span-right">${AllConfig.DT4 | floatFix}°C</span>
                                        </p>
                                        <p class="dtn-allConfig-p">C箱历史最大温度<span
                                                class="dtn-allConfig-span dtn-allConfig-span-right">${AllConfig.DT5 | floatFix}°C</span>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div style=" border: solid 1px #ddd" id="chartContainer">
                            <div id="container" style="min-width:400px;height:415px;"></div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="dtn-footer">
                版本所有：温州医科大学&nbsp;地址：浙江省温州茶山高教园区
            </div>
        </div>

    </div>
</div>

<script type="text/javascript" src="../public/jquery/js/jquery-1.10.2.min.js"></script>
<script type="text/javascript" src="../public/bootstrap/js/bootstrap.min.js"></script>
<script src="../public/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
<script src="../public/bootstrap-datetimepicker/js/bootstrap-datetimepicker.zh-CN.js"></script>
<script src="../public/FileSaver/FileSaver.min.js"></script>
<script src="../public/js-xlsx/xlsx.core.min.js"></script>
<script type="text/javascript" src="../public/tableExport.min.js"></script>
<script src="https://cdn.bootcss.com/axios/0.18.0/axios.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.js"></script>
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<script src="https://cdn.bootcss.com/underscore.js/1.9.0/underscore-min.js"></script>
<script src="../public/file/filesaver.js"></script>
<script src="../public/helper/dt-epo-helpers.js"></script>
<script>

    $(document).ready(function () {

        var startDate = new Date();
        startDate.setFullYear(2018, 6, 1);
        var endDate = new Date();
        endDate.setFullYear(2018, 6, 31);
        $('#daycalendarBox').val(new Date().Format("yyyy-MM-dd"));
        $('#daycalendarBox_end').val(new Date().Format("yyyy-MM-dd"));
        $('.form_date').datetimepicker({
            language: 'zh-CN',
            format: 'yyyy-mm-dd',
            weekStart: 1,
            todayBtn: 1,
            autoclose: 1,
            todayHighlight: 1,
            startView: 2,
            minView: 2,
            forceParse: 0,
//            startDate: startDate,
//            endDate: endDate
        });
        $('.form_date_end').datetimepicker({
            language: 'zh-CN',
            format: 'yyyy-mm-dd',
            weekStart: 1,
            todayBtn: 1,
            autoclose: 1,
            todayHighlight: 1,
            startView: 2,
            minView: 2,
            forceParse: 0,
//            startDate: startDate,
//            endDate: endDate
        });

        function logOut() {
            sessionStorage.removeItem('user');
            sessionStorage.removeItem('isLogin');
            window.location.href = 'index';
        }

        $('.dt-nav-quit').click(function () {
            logOut();
        });

        $('#chartContainer').hide();
    });


    const navMessage = {
        navMessage: [{
            "home": "图书馆",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        }, {
            "home": "同仁楼",
            "deskList": [{
                "name": "I段进线变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "同德楼",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        }, {
            "home": "同济楼",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        }, {
            "home": "学生活动中心",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "一期宿舍",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器", "Ⅲ段进线变压器"]
            }]
        }, {
            "home": "二期宿舍",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器", "Ⅲ段进线变压器"]
            }]
        }, {
            "home": "中试基地",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "学院路2#",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "求是楼",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        }, {
            "home": "三期宿舍食堂",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器", "Ⅲ段进线变压器", "Ⅳ段进线变压器", "Ⅴ段进线变压器"]
            }]
        }, {
            "home": "学院路1#",
            "deskList": [{
                "name": "变压器",
                "loop": ["1号变压器8176", "2号变压器8176", "3号变压器288线", "4号变压器288线"]
            }]
        }]
    };


    Date.prototype.Format = function (fmt) { //author: meizz
        var o = {
            "M+": this.getMonth() + 1, //月份
            "d+": this.getDate(), //日
            "h+": this.getHours(), //小时
            "m+": this.getMinutes(), //分
            "s+": this.getSeconds(), //秒
            "q+": Math.floor((this.getMonth() + 3) / 3), //季度
            "S": this.getMilliseconds() //毫秒
        };
        if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
        for (var k in o)
            if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
        return fmt;
    };
    //第一次加载页面，默认渲染图书馆的二级导航栏
    //    $(document).ready(function () {
    //        renderSecondNav("图书馆");
    //        $('#chartContainer').hide();
    //        //$('#dtp_input').val(new Date().Format("yyyy-MM-dd"));
    //        $('#daycalendarBox').val(new Date().Format("yyyy-MM-dd"));
    //    });
    //请求数据
    function getPowerData(obj, index, def) {
        const loading = obj.$loading({
            lock: true,
            text: '查找数据中',
            spinner: 'el-icon-loading',
            background: 'rgba(0, 0, 0, 0.7)'
        });
        //console.log("executed");
        console.log(obj.isShowData);
        if (obj.isShowData) {
            var Time1 = $('#daycalendarBox').val() + ' 00:00:00';
            var Time2 = $('#daycalendarBox').val() + ' 23:59:59';
        } else {
            Time1 = $('#daycalendarBox').val() + ' 00:00:00';
            Time2 = $('#daycalendarBox_end').val() + ' 23:59:59';
        }
        var loopName = $('.loop__content-active').find("span").html();
        var keyObj = keySwitch(loopName, navMessage.navMessage[index].home);
        var typeKey = $("#select").val();
        var homeKey = StringNum(index);
        var key = "";
        //console.log($('.dt-left-nav-box-active').html().toString());
        key = homeKey + keyObj.loopKey + typeKey;
        if (def) {
            key = def.key;
            Time1 = def.Time;
            Time2 = def.Time;
            homeKey = def.homeKey;
        }
        var
            API_STATUS = {
                "apicode": "ElemonitorInfo",
                "args": {
                    "time1": Time1,
                    "time2": Time2,
                    "key": key,
                    "home": homeKey
                }
            };
        axios.post("/api", API_STATUS
            , {
                headers: {
                    'Content-Type': 'application/json'
                }
            }).then(function (res) {
            loading.close();
            if (res.data.obj.length > 0) {
                obj.remainder = res.data.obj[0].TS1;
                obj.loop = $('.loop__content-active span').html();
                var len = res.data.obj.length;
                var prop = [];
                var pop = {};
                for (var j = 0; j < len / 2; j++) {
                    pop = {
                        loop: obj.loop,
                        ST1: res.data.obj[j * 2].TS,
                        DT1: res.data.obj[j * 2].DT,
                        ST2: res.data.obj[j * 2 + 1].TS,
                        DT2: res.data.obj[j * 2 + 1].DT,
                    }
                    prop[j] = pop;
                }
                vm.total = j;
                obj.tableData = prop;
                renderChart(res.data.obj);
            } else {
                loading.close();
                obj.$message.error('暂无当前数据');
                obj.tableData = [];
                console.log('no data');
            }
        }).catch(function (error) {
            console.log(error);
        });

    }


    //渲染二级导航栏(abandon)
    function renderSecondNav(mainNav) {
        var navList = getSecondNav(mainNav);
        var headBegin = ' <div class="dt-tree-node-header"> <span class="glyphicon glyphicon-minus node" aria-hidden="true" style="color: black;"></span> <span class="dt-tree-node-header-font">';
        var headEnd = '</span> </div>';
        var bodyBegin = '<div class="dt-tree-node-container-show"> <div class="dt-tree-node-header dt-tree-node-position"> <span class="dt-tree-node-header-font" style="padding-left:20px; ">';
        var bodyEnd = '</span> </div> <div class="dt-tree-node-container-show"></div> </div>';
        $(".dt-tree-view").html("");
        for (var i = 0; i < navList.length; i++) {
            $(".dt-tree-view").append(headBegin + navList[i].name + headEnd);
            for (var j = 0; j < navList[i].loop.length; j++) {
                $(".dt-tree-view").append(bodyBegin + navList[i].loop[j] + bodyEnd);
            }
        }

        $('.dt-tree-node-header:eq(1)').addClass('dt-tree-node-header-active');

        $('.dt-tree-node-container-show .dt-tree-node-header').click(function () {
            $('.dt-tree-node-header-active').removeClass('dt-tree-node-header-active');
            $(this).addClass('dt-tree-node-header-active');
            getPowerData(vm);
            //console.log("lxy");
        });


    }

    var vm = new Vue({
        el: "#vue-list",
        delimiters: ['${', '}'],
        data: {
            list: [],
            AllConfig: {},
            loop: "I进线",
            remainder: 0,
            fullscreenLoading: false,
            navList: navMessage.navMessage,
            isShowAllConfig: false,
            // 数据页面
            isShowData: false,
            total: 0,//默认数据总数
            pagesize: 11,//每页的数据条数
            currentPage: 1,//默认开始页面
            istag: true,
            tableData: []
        },
        methods: {
            // 数据页面
            tableRowClassName({row, rowIndex}) {
                if (rowIndex === 0) {
                    return 'th';
                }
                return '';
            },
            switchChange() {
                this.istag = !this.istag;

            },
            created: function () {
                this.total = this.tableData.length;
            },
            current_change: function (currentPage) {
                this.currentPage = currentPage;
            },

            // end
            getGetEleMonitorList: function (obj, index) {
                const loading = obj.$loading({
                    lock: true,
                    text: '查找数据中',
                    spinner: 'el-icon-loading',
                    background: 'rgba(0, 0, 0, 0.7)'
                });
                //console.log("executed");
                var Time = $('#daycalendarBox').val();
                var loopName = $('.loop__content-active').find("span").html();
                var keyObj = keySwitch(loopName, navMessage.navMessage[index].home);
                var typeKey = $("#select").val();
                var homeKey = StringNum(index);
                var key = homeKey + keyObj.loopKey + '00';

                //console.log($('.dt-left-nav-box-active').html().toString());
                for (var i = 1; i < 7; i++) {
                    key += (',' + homeKey + keyObj.loopKey + '0' + i.toString());
                }
                var
                    API_STATUS = {
                        "apicode": "GetEleMonitorList",
                        "args": {
                            "key": key,
                            "home": homeKey
                        }
                    };
                axios.post("/api", API_STATUS
                    , {
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    }).then(function (res) {
                    console.log(res.data.obj.data);
                    loading.close();
                    if (res.data.obj.data) {
                        obj.AllConfig = res.data.obj.data;
                    } else {
                        loading.close();
                        obj.$message.error('暂无当前数据');
                        obj.AllConfig = [];
                        console.log('no data');
                    }
                }).catch(function (error) {
                    console.log(error);

                });
            },

            selectLoop: function (obj, index) {
                var _this = this;
                $('.loop__content-active').removeClass("loop__content-active");
                var el = obj.currentTarget;
                $(el).addClass("loop__content-active");
                console.log($(el));
                if (_this.isShowAllConfig) {
                    _this.getGetEleMonitorList(_this, index);
                } else {
                    getPowerData(_this, index);
                }
                sessionStorage.setItem('homeIndex', index);
            },
            search: function () {
                var _this = this;
                var index = sessionStorage.getItem('homeIndex');
                if (index == null) {
                    _this.$message.error("请选择地点");
                    return;
                }
                if (_this.isShowAllConfig) {
                    _this.showAllConfig();
                } else {
                    getPowerData(_this, index);
                }
            },
            switchChart: function () {
                var _this = this;
                _this.isShowAllConfig = false;
                _this.isShowData = false;
                $('#sheetContainer').hide();
                $('#chartContainer').show();
                $(".middle-button").removeClass('dt-btn-active');
                $("#chart").addClass('dt-btn-active');
                var index = sessionStorage.getItem('homeIndex');
                if (index === null) {
                    _this.$message.error('请选择地点');
                    console.log('no home');
                    return;
                }
                renderChart(this.list);
                $('#ele-search').click();
            },
            switchSheet: function () {
                var _this = this;
                var index = sessionStorage.getItem('homeIndex');

                _this.isShowAllConfig = false;
                _this.isShowData = true;

                $('#chartContainer').hide();
                $('#sheetContainer').show();
                $(".middle-button").removeClass('dt-btn-active');
                $("#data").addClass('dt-btn-active');
                if (index === null) {
                    _this.$message.error('请选择地点');
                    console.log('no home');
                    return;
                }
                getPowerData(_this, index);
            },
            handleChange: function (val) {
                console.log(val);
            },
            outPut: function () {
                // $('#outPutTable').tableExport({type: 'excel'}); if (obj.isShowData) {
                var obj = this;
                var index = sessionStorage.getItem('homeIndex');
                const loading = obj.$loading({
                    lock: true,
                    text: '查找数据中',
                    spinner: 'el-icon-loading',
                    background: 'rgba(0, 0, 0, 0.7)'
                });
                if (obj.isShowData) {
                    var Time1 = $('#daycalendarBox').val() + ' 00:00:00';
                    var Time2 = $('#daycalendarBox').val() + ' 23:59:59';
                } else {
                    Time1 = $('#daycalendarBox').val() + ' 00:00:00';
                    Time2 = $('#daycalendarBox_end').val() + ' 23:59:59';
                }
                var loopName = $('.loop__content-active').find("span").html();
                var keyObj = keySwitch(loopName, navMessage.navMessage[index].home);
                var typeKey = $("#select").val();
                var homeKey = StringNum(index);
                var key = "";
                key = homeKey + keyObj.loopKey + typeKey;
                obj.loop = $('.loop__content-active span').html();
                // if () 
                var API_STATUS = {
                    "apicode": "exportMonitorExcel",
                    "args": {
                        "time1": Time1,
                        "time2": Time2,
                        "key": key,
                        "home": homeKey
                    }
                };
                axios.post("/api", API_STATUS, {
                    headers: {
                        'Content-Type': 'application/json'
                    }
                }).then(function (res) {
                    loading.close();
                    if (res.data.obj.blob!=null){
                    var data = res.data.obj.blob;      //要还原成二进制的文件数据

                    var arrBuffer = new ArrayBuffer(data.length);
                    var view = new Uint8Array(arrBuffer);

                    for (var i = 0; i < data.length; i++) {
                        view[i] = data.charCodeAt(i);
                    }
                    var fileName =obj.loop+'.xlsx';
                    var blob = new Blob([arrBuffer], {type: 'application/octet-stream'});
                    saveAs(blob, fileName);
                }
                else{
                  obj.$message.error("暂无当前数据");
                }})

            },
            showAllConfig: function () {
                var _this = this;
                var index = sessionStorage.getItem('homeIndex');
                $('#chartContainer').hide();
                $('#sheetContainer').show();
                $(".middle-button").removeClass('dt-btn-active');
                $("#allConfig").addClass('dt-btn-active');
                _this.isShowAllConfig = true;
                _this.isShowData = false;
                if (index === null) {
                    _this.$message.error('请选择地点');
                    console.log('no home');
                    return;
                }
                _this.getGetEleMonitorList(_this, index);

            }
        },
        filters: {
            switchFilter: function (value) {
                var str = $('select option:selected').html().toString();
                if (str === '风机状态') {
                    value = parseInt(value);
                    if (value === 1) {
                        return '启动'
                    } else if (value === 0) {
                        return '停止'
                    } else {
                        return 'error'
                    }
                } else {
                    return value;
                }
            },

            floatFix: function (value) {
                if (value || value === 0) {
                    value = parseFloat(value);
                    value = Math.round(value * 1000) / 1000;
                    return value;
                } else {
                    return "暂无数据";
                }
            }

        },
        created: function () {
            var isLogin = sessionStorage.getItem('isLogin') || false;
            if (!isLogin) {
                window.location.href = 'index';
            }
            this.showAllConfig();
//            getPowerData(this, {
//                "key": "0000000",
//                "homeKey": "00",
//                "time": "2018-07-01"
//            });
        },
    });


    //切换二级导航栏
    $('.dt-left-nav-box').click(function () {
        $('.dt-left-nav-box-active').removeClass('dt-left-nav-box-active');
        $(this).addClass('dt-left-nav-box-active');
        var home = $(this).html().toString();
        $('.home').html(home);
        renderSecondNav(home);
        getPowerData(vm);
        renderChart(vm);
    });

    function renderChart(obj) {
        var data = [];
        var time = [];
        for (var i = 0; i < obj.length; i++) {
            data.push(obj[i].TS);
        }
        for (i = 0; i < obj.length; i++) {
            time.push(obj[i].DT.toString().substr(10, 6));
        }
        for (var i = 0; i < data.length; i++) {
            data[i] = parseFloat(data[i]);
        }

        var chart = Highcharts.chart('chartContainer', {
            chart: {
                // backgroundColor:'red',
                type: 'areaspline',
                zoomType: 'x',
                panning: true,
                panKey: 'shift',
                style: {
                    fontFamily: "",
                    fontSize: '14px',
                    fontWeight: 'bold',
                    color: '#414E69',
                },
                spacingTop: 50,
            },
            legend: {
                // layout: 'vertical',
                backgroundColor: '#FFFFFF',
                floating: true,
                align: 'center',
                verticalAlign: 'top',
                y: -7,
                backgroundColor: 'transparent',
                symbolHeight: 10,
                itemStyle: {
                    fontSize: '16px',
                    color: '#414E69',
                }
                //labelFormat: '<span style="{color}">{name} (click to hide or show)</span>'
            },
            credits: {
                enabled: false
            },
            title: {
                text: $('select option:selected').html(),
                style: {
                    color: '#ffffff',
                    fontSize: '18px'
                },
                margin: 50
            },
            subtitle: {
                text: '选择区域放大，按住shift拖动鼠标平移',
                floating: false,
            },
            lang: {
                resetZoom: '还原图表',
                resetZoomTitle: '还原图表为1:1大小'
            },
            xAxis: {
                categories: time
            },
            yAxis: {
                title: {
                    text: $('select option:selected').html()
                },
                labels: {
                    formatter: function () {
                        return this.value;
                    },
                    style: {
                        fontSize: '14px',
                        color: ' #414E69'
                    }
                }
            },
            tooltip: {
                crosshairs: true,
                shared: true
            },
            plotOptions: {
                areaspline: {
                    color: '#FF3E3E',
                    lineColor: '#FF3E3E',
                    fillOpacity: 0.2
                }
            },
            scrollbar: {
                enabled: true
            },
            series: [{
                name: $('select option:selected').html(),
                data: data,
                marker: {//线上数据点
                    radius: 3,
                    lineWidth: 1,
                    lineColor: '#FF3E3E',
                    fillColor: '#FF3E3E',
                    states: {
                        hover: {
                            enabled: true
                        }
                    }
                },
                fillColor: {
                    linearGradient: {
                        x1: 0,
                        y1: 0,
                        x2: 0,
                        y2: 1
                    },
                    stops: [
                        [0, '#FF893B'],
                        [1, 'rgba(253,177,126,0.33)']
                    ]
                }
            }]
        });
    }


    //挑选二级导航栏的内容
    function getSecondNav(home) {
        var navMessage = [{
            "home": "图书馆",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        }, {
            "home": "同仁楼",
            "deskList": [{
                "name": "I段进线变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "同德楼",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        }, {
            "home": "同济楼",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        }, {
            "home": "学生活动中心",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "一期宿舍",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器", "Ⅲ段进线变压器"]
            }]
        }, {
            "home": "二期宿舍",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器", "Ⅲ段进线变压器"]
            }]
        }, {
            "home": "中试基地",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "学院路2#",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "求是楼",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        }, {
            "home": "三期宿舍食堂",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器", "Ⅲ段进线变压器", "Ⅳ段进线变压器", "Ⅴ段进线变压器"]
            }]
        }, {
            "home": "学院路1#",
            "deskList": [{
                "name": "变压器",
                "loop": ["1号变压器8176", "2号变压器8176", "3号变压器288线", "4号变压器288线"]
            }]
        }];

        var navList = [];

        for (var i = 0; i < navMessage.length; i++) {
            if (home === navMessage[i].home)
                navList = navMessage[i].deskList;
        }
        return navList;

    }

</script>
</body>
>>>>>>> dedd623 (first)
>>>>>>> 19b8a9c (first)
>>>>>>> 8f5179a (first)
>>>>>>> 87a8fdf (first)
>>>>>>> 1e8021d (first)
>>>>>>> 5938de4 (first)
>>>>>>> c55f785 (first)
</html>