<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
<<<<<<< HEAD
>>>>>>> 19b8a9c (first)
>>>>>>> 8f5179a (first)
>>>>>>> 87a8fdf (first)
>>>>>>> 1e8021d (first)
>>>>>>> 5938de4 (first)
>>>>>>> c55f785 (first)
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>温州医科大学智能监控平台</title>
    <link rel="stylesheet" href="../public/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css"
          href="../public/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css">
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <link rel="stylesheet" href="../assets/css/common.css">
    <link rel="stylesheet" href="../assets/css/navigation.css">
    <link rel="stylesheet" href="../assets/css/tree.css">
    <link rel="stylesheet" href="../assets/css/power_check.css">
    <link rel="stylesheet" href="../assets/css/harmonic.css">
    <script src="../public/jquery/js/jquery-1.10.2.min.js"></script>
    <script src="http://cdn.hcharts.cn/highcharts/highcharts.js"></script>
</head>
<body>
<div class="dt-title-container">
    <div class="dt-nav-title">温州医科大学智能监控平台</div>
    <div onclick="javascript:window.location.href='#';" class="dt-nav-logo">
        <img src="../assets/img/close.png" class="dt-nav-quit">
    </div>
</div>
<div class="dt-nav-container">
    <div class="dt-nav-btn active" onclick="javascript:window.location.href='main'">
        <span class="dt-nav-img dt-nav-general"></span>
        <span>概况</span>
    </div>
    <div class="dt-nav-btn dt-nav-option-active">
        <span class="dt-nav-img dt-nav-monitor"></span>
        <span>变压器监测</span>
    </div>
    <div class="dt-nav-btn" onclick="javascript:window.location.href='harmonic'">
        <span class="dt-nav-img dt-nav-quality"></span>
        电力监测
    </div>
    <!--<div class="dt-nav-btn">-->
    <!--<span class="dt-nav-img dt-nav-analysis"></span>-->
    <!--用电分析-->
    <!--</div>-->
    <!--<div class="dt-nav-btn">-->
    <!--<span class="dt-nav-img dt-nav-security"></span>-->
    <!--安全分析-->
    <!--</div>-->
    <!--<div class="dt-nav-btn">-->
    <!--<span class="dt-nav-img dt-nav-record"></span>-->
    <!--事件记录-->
    <!--</div>-->
    <div class="dt-nav-btn" onclick="javascript:window.location.href='environment'">
        <span class="dt-nav-img dt-nav-environment"></span>
        环境监测
    </div>
    <!--<div class="dt-nav-btn ">-->
    <!--<span class="dt-nav-img dt-nav-administration"></span>-->
    <!--维护管理-->
    <!--</div>-->
    <div class="dt-nav-btn" onclick="javascript:window.location.href='warning'">
        <span class="dt-nav-img dt-nav-warning"></span>
        报警监测
    </div>
    <div class="dt-nav-btn" onclick="javascript:window.location.href='plan'">
        <span class="dt-nav-img dt-nav-record"></span>
        巡察计划
    </div>
</div>
<div id="vue-list" v-cloak>
    <div class="dt-left-nav-container">
        <div class="dt-left-nav-box dt-left-nav-first-box dt-left-nav-box-active">图书馆</div>
        <div class="dt-left-nav-box">同仁楼</div>
        <div class="dt-left-nav-box">同德楼</div>
        <div class="dt-left-nav-box">同济楼</div>
        <div class="dt-left-nav-box">学生活动中心</div>
        <div class="dt-left-nav-box">一期宿舍</div>
        <div class="dt-left-nav-box">二期宿舍</div>
        <!--<div class="dt-left-nav-box">三期宿舍上</div>-->
        <!--<div class="dt-left-nav-box">三期宿舍下</div>-->
        <div class="dt-left-nav-box">中试基地</div>
        <div class="dt-left-nav-box">学院路2#</div>
        <div class="dt-left-nav-box">求是楼</div>
        <div class="dt-left-nav-box">三期宿舍食堂</div>
        <div class="dt-left-nav-box">学院路1#</div>
    </div>
    <div class="dt-main-container" style="overflow:hidden;">
        <div class="dt-main-bac dt-harmonic-flex">
            <div class="dt-harmonic-tree" style="overflow: scroll;">
                <!--<div class="dt-search-container">-->
                <!--<div>变电所名称</div>-->
                <!--<div class="dt-search-flex">-->
                <!--<input class="middle-input dt-harmonic-search-input">-->
                <!--<button class="middle-button dt-harmonic-search-button"></button>-->
                <!--</div>-->
                <!--</div>-->
                <div class="dt-tree-container">
                    <!--<div class="dt-tree-view">-->
                    <!--<div class="dt-tree-node-header">-->
                    <!--<span class="glyphicon glyphicon-minus node" aria-hidden="true" style="color: black;"></span>-->
                    <!--<span class="dt-tree-node-header-font">Ⅰ进线柜</span>-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-container-show">-->
                    <!--&lt;!&ndash;sonNode start&ndash;&gt;-->

                    <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                    <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">Ⅰ进线</span>-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-container-show"></div>-->
                    <!--&lt;!&ndash;sonNode finish&ndash;&gt;-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-header">-->
                    <!--<span class="glyphicon glyphicon-minus node" aria-hidden="true" style="color: black;"></span>-->
                    <!--<span class="dt-tree-node-header-font">D4柜</span>-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-container-show">-->
                    <!--&lt;!&ndash;sonNode start&ndash;&gt;-->

                    <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                    <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">地下室照明</span>-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-container-show">-->

                    <!--</div>-->
                    <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                    <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">网络中心空调</span>-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-container-show">-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                    <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">一层照明</span>-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-container-show">-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                    <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">二层照明</span>-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-container-show">-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                    <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">三层照明</span>-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-container-show">-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                    <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">开闭所照明</span>-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-container-show">-->
                    <!--</div>-->
                    <!--&lt;!&ndash;sonNode finish&ndash;&gt;-->
                    <!--</div>-->
                    <!--</div>-->
                    <div class="dt-tree-view">
                        <!--<div class="dt-tree-node-header">-->
                        <!--<span class="glyphicon glyphicon-minus node" aria-hidden="true" style="color: black;"></span>-->
                        <!--<span class="dt-tree-node-header-font">Ⅰ进线柜</span>-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-container-show">-->
                        <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                        <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">Ⅰ进线</span>-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-container-show"></div>-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-header">-->
                        <!--<span class="glyphicon glyphicon-minus node" aria-hidden="true" style="color: black;"></span>-->
                        <!--<span class="dt-tree-node-header-font">D4柜</span>-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-container-show">-->
                        <!--&lt;!&ndash;sonNode start&ndash;&gt;-->

                        <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                        <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">地下室照明</span>-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-container-show">-->

                        <!--</div>-->
                        <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                        <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">网络中心空调</span>-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-container-show">-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                        <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">一层照明</span>-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-container-show">-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                        <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">二层照明</span>-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-container-show">-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                        <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">三层照明</span>-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-container-show">-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                        <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">开闭所照明</span>-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-container-show">-->
                        <!--</div>-->
                        <!--&lt;!&ndash;sonNode finish&ndash;&gt;-->
                        <!--</div>-->
                    </div>
                </div>
            </div>
            <div class="dt-main-right" id="dt-main-right">
                <div class="dt-harmonic-date-select">
                    <div class="form-group form-group-custom dt-harmonic-from-group-custom">
                        <label for="dtp_input" class="control-label">起始日期：</label>
                        <div class="input-group date form_date dt-harmonic-input-group-custom" data-date=""
                             data-date-format="dd MM yyyy" data-link-field="dtp_input" data-link-format="yyyy-mm-dd"
                             id="datetimepicker">
                            <input class="form-control" size="16" type="text" value="" readonly id="daycalendarBox">
                            <span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>
                            <span class="input-group-addon" id="calendar"><span
                                    class="glyphicon glyphicon-calendar"></span></span>
                        </div>
                        <input type="hidden" id="dtp_input"/><br/>
                    </div>
                    <label class="dt-harmonic-power-type">电力类别：</label>
                    <div id="hideDiv">0</div>
                    <select class="dt-harmonic-select" id="select">
                        <option value="00">A相温度</option>
                        <option value="01">B相温度</option>
                        <option value="02">C相温度</option>
                        <option value="03">A相历史最大温度</option>
                        <option value="04">B相历史最大温度</option>
                        <option value="05">C相历史最大温度</option>
                        <option value="06">风机状态</option>
                    </select>
                    <!--<input type="checkbox" class="dt-harmonic-check-box" id="fla">-->
                    <!--<span id="noteA">A相</span>-->
                    <!--<input type="checkbox" class="dt-harmonic-check-box" id="flb">-->
                    <!--<span id="noteB">B相</span>-->
                    <!--<input type="checkbox" class="dt-harmonic-check-box" id="flc">-->
                    <!--<span id="noteC">C相</span>-->
                    <!--<button class="middle-button">上一日</button>-->
                    <!--<button class="middle-button">下一日</button>-->
                    <button class="middle-button dt-btn-check-search" @click="search">查询</button>
                </div>
                <div class="dt-harmonic-btn-container">
                    <button class="middle-button dt-middle-button-position dt-btn-check-search dt-btn-data dt-btn-active"
                            id="data" @click="switchSheet" style="float: none;">数据
                    </button>
                    <button class="middle-button dt-middle-button-position dt-btn-check-search dt-btn-chart" id="chart"
                            style="float: none;" @click="switchChart">图表
                    </button>
                    <span>
                    <!--电量：<span>${remainder}</span>剩余-->
                </span>
                </div>
                <div class="dt-harmonic-sheet" id="sheetContainer">
                    <div class="table-responsive table-responsive-custom" style="overflow:scroll;">
                        <table class="table table-striped table-custom">
                            <thead class="main-box-top">
                            <tr>
                                <th>回路名称</th>
                                <th>采集时间</th>
                                <th>数据</th>
                            </tr>
                            </thead>
                            <tr v-for="data in list">
                                <th>${loop}</th>
                                <th>${data.DT}</th>
                                <th>${data.TS | switchFilter}</th>
                            </tr>

                        </table>

                    </div>
                </div>
                <div style="border: solid 1px #ddd" id="chartContainer">
                    <div id="container" style="min-width:400px;height:415px;"></div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="dt-footer">登录用户：admin</div>
<script type="text/javascript" src="../public/jquery/js/jquery-1.10.2.min.js"></script>
<script type="text/javascript" src="../public/bootstrap/js/bootstrap.min.js"></script>
<script src="../public/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
<script src="../public/bootstrap-datetimepicker/js/bootstrap-datetimepicker.zh-CN.js"></script>
<script src="https://cdn.bootcss.com/axios/0.18.0/axios.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.js"></script>
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<script src="https://cdn.bootcss.com/underscore.js/1.9.0/underscore-min.js"></script>
<script src="../public/helper/dt-epo-helpers.js"></script>
<script>
    Date.prototype.Format = function (fmt) { //author: meizz
        var o = {
            "M+": this.getMonth() + 1, //月份
            "d+": this.getDate(), //日
            "h+": this.getHours(), //小时
            "m+": this.getMinutes(), //分
            "s+": this.getSeconds(), //秒
            "q+": Math.floor((this.getMonth() + 3) / 3), //季度
            "S": this.getMilliseconds() //毫秒
        };
        if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
        for (var k in o)
            if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
        return fmt;
    };
    //第一次加载页面，默认渲染图书馆的二级导航栏
    $(document).ready(function () {
        renderSecondNav("图书馆");
        $('#chartContainer').hide();
        //$('#dtp_input').val(new Date().Format("yyyy-MM-dd"));
        $('#daycalendarBox').val(new Date().Format("yyyy-MM-dd"));
    });
    //请求数据
    function getPowerData(obj, def) {
        const loading = obj.$loading({
            lock: true,
            text: '查找数据中',
            spinner: 'el-icon-loading',
            background: 'rgba(0, 0, 0, 0.7)'
        });
        //console.log("executed");
        var Time = $('#daycalendarBox').val();
        var loopName = $('.dt-tree-node-header-active').find("span").html();
        var keyObj = keySwitch(loopName);
        var typeKey = $("#select").val();
        var homeKey = homeKeySwitch($('.dt-left-nav-box-active').html().toString());
        var key = "";
        //console.log($('.dt-left-nav-box-active').html().toString());
        key = homeKey + keyObj.loopKey + typeKey;
        if (def) {
            key = def.key;
            Time = def.Time;
            homeKey = def.homeKey;
        }
        console.log({
            "time": Time,
            "key": key ,
            "home": homeKey
        });
        var
            API_STATUS = {
                "apicode": "ElemonitorInfo",
                "args": {
                    "time": Time,
                    "key": key,
                    "home": homeKey
                }
            };
        axios.post("/api", API_STATUS
            , {
                headers: {
                    'Content-Type': 'application/json'
                }
            }).then(function (res) {
            loading.close();
                console.log(res.data.obj);
            if (res.data.obj.length>0) {
                obj.list = res.data.obj;
                obj.remainder = res.data.obj[0].TS1;
                obj.loop = $('.dt-tree-node-header-active span').html();
                renderChart(res.data.obj);
            } else {
                loading.close();
                obj.$message.error('暂无当前数据');
                console.log('no data');
            }
        }).catch(function (error) {
            console.log(error);

        });

    }


    //渲染二级导航栏
    function renderSecondNav(mainNav) {
        var navList = getSecondNav(mainNav);
        var headBegin = ' <div class="dt-tree-node-header"> <span class="glyphicon glyphicon-minus node" aria-hidden="true" style="color: black;"></span> <span class="dt-tree-node-header-font">';
        var headEnd = '</span> </div>';
        var bodyBegin = '<div class="dt-tree-node-container-show"> <div class="dt-tree-node-header dt-tree-node-position"> <span class="dt-tree-node-header-font" style="padding-left:20px; ">';
        var bodyEnd = '</span> </div> <div class="dt-tree-node-container-show"></div> </div>';
        $(".dt-tree-view").html("");
        for (var i = 0; i < navList.length; i++) {
            $(".dt-tree-view").append(headBegin + navList[i].name + headEnd);
            for (var j = 0; j < navList[i].loop.length; j++) {
                $(".dt-tree-view").append(bodyBegin + navList[i].loop[j] + bodyEnd);
            }
        }

        $('.dt-tree-node-header:eq(1)').addClass('dt-tree-node-header-active');

        $('.dt-tree-node-container-show .dt-tree-node-header').click(function () {
            $('.dt-tree-node-header-active').removeClass('dt-tree-node-header-active');
            $(this).addClass('dt-tree-node-header-active');
            getPowerData(vm);
            //console.log("lxy");
        });

        var startDate = new Date();
        startDate.setFullYear(2018, 6, 1);
        var endDate = new Date();
        endDate.setFullYear(2018, 6, 31);
        $('.form_date').datetimepicker({
            language: 'zh-CN',
            format: 'yyyy-mm-dd',
            weekStart: 1,
            todayBtn: 1,
            autoclose: 1,
            todayHighlight: 1,
            startView: 2,
            minView: 2,
            forceParse: 0,
            activeNames: 1,
//            startDate: startDate,
//            endDate: endDate
        });

    }

    var vm = new Vue({
        el: "#vue-list",
        delimiters: ['${', '}'],
        data: {
            list: [],
            loop: "I进线",
            remainder: 0,
            fullscreenLoading: false
        },
        methods: {
            search: function () {
                getPowerData(this);
            },
            switchChart: function () {
                $('#sheetContainer').hide();
                $('#chartContainer').show();
                $("#data").removeClass('dt-btn-active');
                $("#chart").addClass('dt-btn-active');
                renderChart(this.list);
            },
            switchSheet: function () {
                console.log('switchSheet');
                $('#chartContainer').hide();
                $('#sheetContainer').show();
                $("#chart").removeClass('dt-btn-active');
                $("#data").addClass('dt-btn-active');
            },
            handleChange: function(val) {
                console.log(val);
            }
        },
        filters:{
            switchFilter:function (value) {
                var str = $('select option:selected').html().toString();
                if(str==='风机状态'){
                    value=parseInt(value);
                    if(value===1){
                        return '启动'
                    }else if(value===0){
                        return '停止'
                    }else{
                        return 'error'
                    }
                }else{
                    return value;
                }
            }

        },
        created: function () {
            getPowerData(this, {
                "key": "0000000",
                "homeKey": "00",
                "time": "2018-07-01"
            });
        }
    });



    //切换二级导航栏
    $('.dt-left-nav-box').click(function () {
        $('.dt-left-nav-box-active').removeClass('dt-left-nav-box-active');
        $(this).addClass('dt-left-nav-box-active');
        var home = $(this).html().toString();
        $('.home').html(home);
        renderSecondNav(home);
        getPowerData(vm);
        renderChart(vm);
    });

    function renderChart(obj) {
        var data = [];
        var time = [];
        for (var i = 0; i < obj.length; i++) {
            data.push(obj[i].TS);
        }
        for (i = 0; i < obj.length; i++) {
            time.push(obj[i].DT);
        }
        for (var i = 0; i < data.length; i++) {
            data[i] = parseFloat(data[i]);
        }
        var chart = Highcharts.chart('chartContainer', {
            chart: {
                type: 'spline',
                zoomType: 'x',
                panning: true,
                panKey: 'shift'
            },

            credits: {
                enabled: false
            },
            title:{
                text:$('select option:selected').html()
            },
            subtitle: {
                text: '选择区域放大，按住shift拖动鼠标平移'
            },
            lang:{
                resetZoom:'还原图表',
                resetZoomTitle:'还原图表为1:1大小'
            },
            xAxis: {
                categories: time
                //tickInterval:5
                //tickWidth:10
            },
            yAxis: {
                title: {
                    text: $('select option:selected').html()
                },
                labels: {
                    formatter: function () {
                        return this.value;
                    }
                }
            },
            tooltip: {
                crosshairs: true,
                shared: true
            },
            plotOptions: {
                spline: {
                    marker: {
                        radius: 2,
                        lineColor: '#ffffff',
                        lineWidth: 0
                    }
                }
            },
            scrollbar: {
                enabled: true
            },
            series: [{
                name: $('select option:selected').html(),
                data: data
            }]
        });
    }

    var navMessage = [{
        "home": "图书馆",
        "deskList": [{
            "name": "变压器",
            "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
        }]
    }, {
        "home": "同仁楼",
        "deskList": [{
            "name": "I段进线变压器",
            "loop": ["Ⅰ段进线变压器"]
        }]
    }, {
        "home": "同德楼",
        "deskList": [{
            "name": "变压器",
            "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
        }]
    }, {
        "home": "同济楼",
        "deskList": [{
            "name": "变压器",
            "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
        }]
    },  {
        "home": "学生活动中心",
        "deskList": [{
            "name": "变压器",
            "loop": ["Ⅰ段进线变压器"]
        }]
    }, {
        "home": "一期宿舍",
        "deskList": [{
            "name": "变压器",
            "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器","Ⅲ段进线变压器"]
        }]
    }, {
        "home": "二期宿舍",
        "deskList": [{
            "name": "变压器",
            "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器","Ⅲ段进线变压器"]
        }]
    }, {
        "home": "中试基地",
        "deskList": [{
            "name": "变压器",
            "loop": ["Ⅰ段进线变压器"]
        }]
    }, {
        "home": "学院路2#",
        "deskList": [{
            "name": "变压器",
            "loop": ["Ⅰ段进线变压器"]
        }]
    }, {
        "home": "求是楼",
        "deskList": [{
            "name": "变压器",
            "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
        }]
    }, {
        "home": "三期宿舍食堂",
        "deskList": [{
            "name": "变压器",
            "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器","Ⅲ段进线变压器","Ⅳ段进线变压器","Ⅴ段进线变压器"]
        }]
    }, {
        "home": "学院路1#",
        "deskList": [{
            "name": "变压器",
            "loop": ["1号变压器8176","2号变压器8176","3号变压器288线","4号变压器288线"]
        }]
    }];


    //挑选二级导航栏的内容
    function getSecondNav(home) {
        var navMessage = navMessage = [{
            "home": "图书馆",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        }, {
            "home": "同仁楼",
            "deskList": [{
                "name": "I段进线变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "同德楼",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        }, {
            "home": "同济楼",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        },  {
            "home": "学生活动中心",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "一期宿舍",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器","Ⅲ段进线变压器"]
            }]
        }, {
            "home": "二期宿舍",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器","Ⅲ段进线变压器"]
            }]
        }, {
            "home": "中试基地",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "学院路2#",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "求是楼",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        }, {
            "home": "三期宿舍食堂",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器","Ⅲ段进线变压器","Ⅳ段进线变压器","Ⅴ段进线变压器"]
            }]
        }, {
            "home": "学院路1#",
            "deskList": [{
                "name": "变压器",
                "loop": ["1号变压器8176","2号变压器8176","3号变压器288线","4号变压器288线"]
            }]
        }];

        var navList = [];

        for (var i = 0; i < navMessage.length; i++) {
            if (home === navMessage[i].home)
                navList = navMessage[i].deskList;
        }
        return navList;

    }
</script>
</body>
<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
=======
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>温州医科大学智能监控平台</title>
    <link rel="stylesheet" href="../public/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css"
          href="../public/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css">
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <link rel="stylesheet" href="../assets/css/common.css">
    <link rel="stylesheet" href="../assets/css/navigation.css">
    <link rel="stylesheet" href="../assets/css/tree.css">
    <link rel="stylesheet" href="../assets/css/power_check.css">
    <link rel="stylesheet" href="../assets/css/harmonic.css">
    <script src="../public/jquery/js/jquery-1.10.2.min.js"></script>
    <script src="http://cdn.hcharts.cn/highcharts/highcharts.js"></script>
</head>
<body>
<div class="dt-title-container">
    <div class="dt-nav-title">温州医科大学智能监控平台</div>
    <div onclick="javascript:window.location.href='#';" class="dt-nav-logo">
        <img src="../assets/img/close.png" class="dt-nav-quit">
    </div>
</div>
<div class="dt-nav-container">
    <div class="dt-nav-btn active" onclick="javascript:window.location.href='main'">
        <span class="dt-nav-img dt-nav-general"></span>
        <span>概况</span>
    </div>
    <div class="dt-nav-btn dt-nav-option-active">
        <span class="dt-nav-img dt-nav-monitor"></span>
        <span>变压器监测</span>
    </div>
    <div class="dt-nav-btn" onclick="javascript:window.location.href='harmonic'">
        <span class="dt-nav-img dt-nav-quality"></span>
        电力监测
    </div>
    <!--<div class="dt-nav-btn">-->
    <!--<span class="dt-nav-img dt-nav-analysis"></span>-->
    <!--用电分析-->
    <!--</div>-->
    <!--<div class="dt-nav-btn">-->
    <!--<span class="dt-nav-img dt-nav-security"></span>-->
    <!--安全分析-->
    <!--</div>-->
    <!--<div class="dt-nav-btn">-->
    <!--<span class="dt-nav-img dt-nav-record"></span>-->
    <!--事件记录-->
    <!--</div>-->
    <div class="dt-nav-btn" onclick="javascript:window.location.href='environment'">
        <span class="dt-nav-img dt-nav-environment"></span>
        环境监测
    </div>
    <!--<div class="dt-nav-btn ">-->
    <!--<span class="dt-nav-img dt-nav-administration"></span>-->
    <!--维护管理-->
    <!--</div>-->
    <div class="dt-nav-btn" onclick="javascript:window.location.href='warning'">
        <span class="dt-nav-img dt-nav-warning"></span>
        报警监测
    </div>
    <div class="dt-nav-btn" onclick="javascript:window.location.href='plan'">
        <span class="dt-nav-img dt-nav-record"></span>
        巡察计划
    </div>
</div>
<div id="vue-list" v-cloak>
    <div class="dt-left-nav-container">
        <div class="dt-left-nav-box dt-left-nav-first-box dt-left-nav-box-active">图书馆</div>
        <div class="dt-left-nav-box">同仁楼</div>
        <div class="dt-left-nav-box">同德楼</div>
        <div class="dt-left-nav-box">同济楼</div>
        <div class="dt-left-nav-box">学生活动中心</div>
        <div class="dt-left-nav-box">一期宿舍</div>
        <div class="dt-left-nav-box">二期宿舍</div>
        <!--<div class="dt-left-nav-box">三期宿舍上</div>-->
        <!--<div class="dt-left-nav-box">三期宿舍下</div>-->
        <div class="dt-left-nav-box">中试基地</div>
        <div class="dt-left-nav-box">学院路2#</div>
        <div class="dt-left-nav-box">求是楼</div>
        <div class="dt-left-nav-box">三期宿舍食堂</div>
        <div class="dt-left-nav-box">学院路1#</div>
    </div>
    <div class="dt-main-container" style="overflow:hidden;">
        <div class="dt-main-bac dt-harmonic-flex">
            <div class="dt-harmonic-tree" style="overflow: scroll;">
                <!--<div class="dt-search-container">-->
                <!--<div>变电所名称</div>-->
                <!--<div class="dt-search-flex">-->
                <!--<input class="middle-input dt-harmonic-search-input">-->
                <!--<button class="middle-button dt-harmonic-search-button"></button>-->
                <!--</div>-->
                <!--</div>-->
                <div class="dt-tree-container">
                    <!--<div class="dt-tree-view">-->
                    <!--<div class="dt-tree-node-header">-->
                    <!--<span class="glyphicon glyphicon-minus node" aria-hidden="true" style="color: black;"></span>-->
                    <!--<span class="dt-tree-node-header-font">Ⅰ进线柜</span>-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-container-show">-->
                    <!--&lt;!&ndash;sonNode start&ndash;&gt;-->

                    <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                    <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">Ⅰ进线</span>-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-container-show"></div>-->
                    <!--&lt;!&ndash;sonNode finish&ndash;&gt;-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-header">-->
                    <!--<span class="glyphicon glyphicon-minus node" aria-hidden="true" style="color: black;"></span>-->
                    <!--<span class="dt-tree-node-header-font">D4柜</span>-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-container-show">-->
                    <!--&lt;!&ndash;sonNode start&ndash;&gt;-->

                    <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                    <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">地下室照明</span>-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-container-show">-->

                    <!--</div>-->
                    <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                    <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">网络中心空调</span>-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-container-show">-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                    <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">一层照明</span>-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-container-show">-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                    <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">二层照明</span>-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-container-show">-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                    <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">三层照明</span>-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-container-show">-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                    <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">开闭所照明</span>-->
                    <!--</div>-->
                    <!--<div class="dt-tree-node-container-show">-->
                    <!--</div>-->
                    <!--&lt;!&ndash;sonNode finish&ndash;&gt;-->
                    <!--</div>-->
                    <!--</div>-->
                    <div class="dt-tree-view">
                        <!--<div class="dt-tree-node-header">-->
                        <!--<span class="glyphicon glyphicon-minus node" aria-hidden="true" style="color: black;"></span>-->
                        <!--<span class="dt-tree-node-header-font">Ⅰ进线柜</span>-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-container-show">-->
                        <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                        <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">Ⅰ进线</span>-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-container-show"></div>-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-header">-->
                        <!--<span class="glyphicon glyphicon-minus node" aria-hidden="true" style="color: black;"></span>-->
                        <!--<span class="dt-tree-node-header-font">D4柜</span>-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-container-show">-->
                        <!--&lt;!&ndash;sonNode start&ndash;&gt;-->

                        <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                        <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">地下室照明</span>-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-container-show">-->

                        <!--</div>-->
                        <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                        <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">网络中心空调</span>-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-container-show">-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                        <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">一层照明</span>-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-container-show">-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                        <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">二层照明</span>-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-container-show">-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                        <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">三层照明</span>-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-container-show">-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-header dt-tree-node-position">-->
                        <!--<span class="dt-tree-node-header-font" style="padding-left:40px; ">开闭所照明</span>-->
                        <!--</div>-->
                        <!--<div class="dt-tree-node-container-show">-->
                        <!--</div>-->
                        <!--&lt;!&ndash;sonNode finish&ndash;&gt;-->
                        <!--</div>-->
                    </div>
                </div>
            </div>
            <div class="dt-main-right" id="dt-main-right">
                <div class="dt-harmonic-date-select">
                    <div class="form-group form-group-custom dt-harmonic-from-group-custom">
                        <label for="dtp_input" class="control-label">起始日期：</label>
                        <div class="input-group date form_date dt-harmonic-input-group-custom" data-date=""
                             data-date-format="dd MM yyyy" data-link-field="dtp_input" data-link-format="yyyy-mm-dd"
                             id="datetimepicker">
                            <input class="form-control" size="16" type="text" value="" readonly id="daycalendarBox">
                            <span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>
                            <span class="input-group-addon" id="calendar"><span
                                    class="glyphicon glyphicon-calendar"></span></span>
                        </div>
                        <input type="hidden" id="dtp_input"/><br/>
                    </div>
                    <label class="dt-harmonic-power-type">电力类别：</label>
                    <div id="hideDiv">0</div>
                    <select class="dt-harmonic-select" id="select">
                        <option value="00">A相温度</option>
                        <option value="01">B相温度</option>
                        <option value="02">C相温度</option>
                        <option value="03">A相历史最大温度</option>
                        <option value="04">B相历史最大温度</option>
                        <option value="05">C相历史最大温度</option>
                        <option value="06">风机状态</option>
                    </select>
                    <!--<input type="checkbox" class="dt-harmonic-check-box" id="fla">-->
                    <!--<span id="noteA">A相</span>-->
                    <!--<input type="checkbox" class="dt-harmonic-check-box" id="flb">-->
                    <!--<span id="noteB">B相</span>-->
                    <!--<input type="checkbox" class="dt-harmonic-check-box" id="flc">-->
                    <!--<span id="noteC">C相</span>-->
                    <!--<button class="middle-button">上一日</button>-->
                    <!--<button class="middle-button">下一日</button>-->
                    <button class="middle-button dt-btn-check-search" @click="search">查询</button>
                </div>
                <div class="dt-harmonic-btn-container">
                    <button class="middle-button dt-middle-button-position dt-btn-check-search dt-btn-data dt-btn-active"
                            id="data" @click="switchSheet" style="float: none;">数据
                    </button>
                    <button class="middle-button dt-middle-button-position dt-btn-check-search dt-btn-chart" id="chart"
                            style="float: none;" @click="switchChart">图表
                    </button>
                    <span>
                    <!--电量：<span>${remainder}</span>剩余-->
                </span>
                </div>
                <div class="dt-harmonic-sheet" id="sheetContainer">
                    <div class="table-responsive table-responsive-custom" style="overflow:scroll;">
                        <table class="table table-striped table-custom">
                            <thead class="main-box-top">
                            <tr>
                                <th>回路名称</th>
                                <th>采集时间</th>
                                <th>数据</th>
                            </tr>
                            </thead>
                            <tr v-for="data in list">
                                <th>${loop}</th>
                                <th>${data.DT}</th>
                                <th>${data.TS | switchFilter}</th>
                            </tr>

                        </table>

                    </div>
                </div>
                <div style="border: solid 1px #ddd" id="chartContainer">
                    <div id="container" style="min-width:400px;height:415px;"></div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="dt-footer">登录用户：admin</div>
<script type="text/javascript" src="../public/jquery/js/jquery-1.10.2.min.js"></script>
<script type="text/javascript" src="../public/bootstrap/js/bootstrap.min.js"></script>
<script src="../public/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
<script src="../public/bootstrap-datetimepicker/js/bootstrap-datetimepicker.zh-CN.js"></script>
<script src="https://cdn.bootcss.com/axios/0.18.0/axios.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.js"></script>
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<script src="https://cdn.bootcss.com/underscore.js/1.9.0/underscore-min.js"></script>
<script src="../public/helper/dt-epo-helpers.js"></script>
<script>
    Date.prototype.Format = function (fmt) { //author: meizz
        var o = {
            "M+": this.getMonth() + 1, //月份
            "d+": this.getDate(), //日
            "h+": this.getHours(), //小时
            "m+": this.getMinutes(), //分
            "s+": this.getSeconds(), //秒
            "q+": Math.floor((this.getMonth() + 3) / 3), //季度
            "S": this.getMilliseconds() //毫秒
        };
        if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
        for (var k in o)
            if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
        return fmt;
    };
    //第一次加载页面，默认渲染图书馆的二级导航栏
    $(document).ready(function () {
        renderSecondNav("图书馆");
        $('#chartContainer').hide();
        //$('#dtp_input').val(new Date().Format("yyyy-MM-dd"));
        $('#daycalendarBox').val(new Date().Format("yyyy-MM-dd"));
    });
    //请求数据
    function getPowerData(obj, def) {
        const loading = obj.$loading({
            lock: true,
            text: '查找数据中',
            spinner: 'el-icon-loading',
            background: 'rgba(0, 0, 0, 0.7)'
        });
        //console.log("executed");
        var Time = $('#daycalendarBox').val();
        var loopName = $('.dt-tree-node-header-active').find("span").html();
        var keyObj = keySwitch(loopName);
        var typeKey = $("#select").val();
        var homeKey = homeKeySwitch($('.dt-left-nav-box-active').html().toString());
        var key = "";
        //console.log($('.dt-left-nav-box-active').html().toString());
        key = homeKey + keyObj.loopKey + typeKey;
        if (def) {
            key = def.key;
            Time = def.Time;
            homeKey = def.homeKey;
        }
        console.log({
            "time": Time,
            "key": key ,
            "home": homeKey
        });
        var
            API_STATUS = {
                "apicode": "ElemonitorInfo",
                "args": {
                    "time": Time,
                    "key": key,
                    "home": homeKey
                }
            };
        axios.post("/api", API_STATUS
            , {
                headers: {
                    'Content-Type': 'application/json'
                }
            }).then(function (res) {
            loading.close();
                console.log(res.data.obj);
            if (res.data.obj.length>0) {
                obj.list = res.data.obj;
                obj.remainder = res.data.obj[0].TS1;
                obj.loop = $('.dt-tree-node-header-active span').html();
                renderChart(res.data.obj);
            } else {
                loading.close();
                obj.$message.error('暂无当前数据');
                console.log('no data');
            }
        }).catch(function (error) {
            console.log(error);

        });

    }


    //渲染二级导航栏
    function renderSecondNav(mainNav) {
        var navList = getSecondNav(mainNav);
        var headBegin = ' <div class="dt-tree-node-header"> <span class="glyphicon glyphicon-minus node" aria-hidden="true" style="color: black;"></span> <span class="dt-tree-node-header-font">';
        var headEnd = '</span> </div>';
        var bodyBegin = '<div class="dt-tree-node-container-show"> <div class="dt-tree-node-header dt-tree-node-position"> <span class="dt-tree-node-header-font" style="padding-left:20px; ">';
        var bodyEnd = '</span> </div> <div class="dt-tree-node-container-show"></div> </div>';
        $(".dt-tree-view").html("");
        for (var i = 0; i < navList.length; i++) {
            $(".dt-tree-view").append(headBegin + navList[i].name + headEnd);
            for (var j = 0; j < navList[i].loop.length; j++) {
                $(".dt-tree-view").append(bodyBegin + navList[i].loop[j] + bodyEnd);
            }
        }

        $('.dt-tree-node-header:eq(1)').addClass('dt-tree-node-header-active');

        $('.dt-tree-node-container-show .dt-tree-node-header').click(function () {
            $('.dt-tree-node-header-active').removeClass('dt-tree-node-header-active');
            $(this).addClass('dt-tree-node-header-active');
            getPowerData(vm);
            //console.log("lxy");
        });

        var startDate = new Date();
        startDate.setFullYear(2018, 6, 1);
        var endDate = new Date();
        endDate.setFullYear(2018, 6, 31);
        $('.form_date').datetimepicker({
            language: 'zh-CN',
            format: 'yyyy-mm-dd',
            weekStart: 1,
            todayBtn: 1,
            autoclose: 1,
            todayHighlight: 1,
            startView: 2,
            minView: 2,
            forceParse: 0,
            activeNames: 1,
//            startDate: startDate,
//            endDate: endDate
        });

    }

    var vm = new Vue({
        el: "#vue-list",
        delimiters: ['${', '}'],
        data: {
            list: [],
            loop: "I进线",
            remainder: 0,
            fullscreenLoading: false
        },
        methods: {
            search: function () {
                getPowerData(this);
            },
            switchChart: function () {
                $('#sheetContainer').hide();
                $('#chartContainer').show();
                $("#data").removeClass('dt-btn-active');
                $("#chart").addClass('dt-btn-active');
                renderChart(this.list);
            },
            switchSheet: function () {
                console.log('switchSheet');
                $('#chartContainer').hide();
                $('#sheetContainer').show();
                $("#chart").removeClass('dt-btn-active');
                $("#data").addClass('dt-btn-active');
            },
            handleChange: function(val) {
                console.log(val);
            }
        },
        filters:{
            switchFilter:function (value) {
                var str = $('select option:selected').html().toString();
                if(str==='风机状态'){
                    value=parseInt(value);
                    if(value===1){
                        return '启动'
                    }else if(value===0){
                        return '停止'
                    }else{
                        return 'error'
                    }
                }else{
                    return value;
                }
            }

        },
        created: function () {
            getPowerData(this, {
                "key": "0000000",
                "homeKey": "00",
                "time": "2018-07-01"
            });
        }
    });



    //切换二级导航栏
    $('.dt-left-nav-box').click(function () {
        $('.dt-left-nav-box-active').removeClass('dt-left-nav-box-active');
        $(this).addClass('dt-left-nav-box-active');
        var home = $(this).html().toString();
        $('.home').html(home);
        renderSecondNav(home);
        getPowerData(vm);
        renderChart(vm);
    });

    function renderChart(obj) {
        var data = [];
        var time = [];
        for (var i = 0; i < obj.length; i++) {
            data.push(obj[i].TS);
        }
        for (i = 0; i < obj.length; i++) {
            time.push(obj[i].DT);
        }
        for (var i = 0; i < data.length; i++) {
            data[i] = parseFloat(data[i]);
        }
        var chart = Highcharts.chart('chartContainer', {
            chart: {
                type: 'spline',
                zoomType: 'x',
                panning: true,
                panKey: 'shift'
            },

            credits: {
                enabled: false
            },
            title:{
                text:$('select option:selected').html()
            },
            subtitle: {
                text: '选择区域放大，按住shift拖动鼠标平移'
            },
            lang:{
                resetZoom:'还原图表',
                resetZoomTitle:'还原图表为1:1大小'
            },
            xAxis: {
                categories: time
                //tickInterval:5
                //tickWidth:10
            },
            yAxis: {
                title: {
                    text: $('select option:selected').html()
                },
                labels: {
                    formatter: function () {
                        return this.value;
                    }
                }
            },
            tooltip: {
                crosshairs: true,
                shared: true
            },
            plotOptions: {
                spline: {
                    marker: {
                        radius: 2,
                        lineColor: '#ffffff',
                        lineWidth: 0
                    }
                }
            },
            scrollbar: {
                enabled: true
            },
            series: [{
                name: $('select option:selected').html(),
                data: data
            }]
        });
    }

    var navMessage = [{
        "home": "图书馆",
        "deskList": [{
            "name": "变压器",
            "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
        }]
    }, {
        "home": "同仁楼",
        "deskList": [{
            "name": "I段进线变压器",
            "loop": ["Ⅰ段进线变压器"]
        }]
    }, {
        "home": "同德楼",
        "deskList": [{
            "name": "变压器",
            "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
        }]
    }, {
        "home": "同济楼",
        "deskList": [{
            "name": "变压器",
            "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
        }]
    },  {
        "home": "学生活动中心",
        "deskList": [{
            "name": "变压器",
            "loop": ["Ⅰ段进线变压器"]
        }]
    }, {
        "home": "一期宿舍",
        "deskList": [{
            "name": "变压器",
            "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器","Ⅲ段进线变压器"]
        }]
    }, {
        "home": "二期宿舍",
        "deskList": [{
            "name": "变压器",
            "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器","Ⅲ段进线变压器"]
        }]
    }, {
        "home": "中试基地",
        "deskList": [{
            "name": "变压器",
            "loop": ["Ⅰ段进线变压器"]
        }]
    }, {
        "home": "学院路2#",
        "deskList": [{
            "name": "变压器",
            "loop": ["Ⅰ段进线变压器"]
        }]
    }, {
        "home": "求是楼",
        "deskList": [{
            "name": "变压器",
            "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
        }]
    }, {
        "home": "三期宿舍食堂",
        "deskList": [{
            "name": "变压器",
            "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器","Ⅲ段进线变压器","Ⅳ段进线变压器","Ⅴ段进线变压器"]
        }]
    }, {
        "home": "学院路1#",
        "deskList": [{
            "name": "变压器",
            "loop": ["1号变压器8176","2号变压器8176","3号变压器288线","4号变压器288线"]
        }]
    }];


    //挑选二级导航栏的内容
    function getSecondNav(home) {
        var navMessage = navMessage = [{
            "home": "图书馆",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        }, {
            "home": "同仁楼",
            "deskList": [{
                "name": "I段进线变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "同德楼",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        }, {
            "home": "同济楼",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        },  {
            "home": "学生活动中心",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "一期宿舍",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器","Ⅲ段进线变压器"]
            }]
        }, {
            "home": "二期宿舍",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器","Ⅲ段进线变压器"]
            }]
        }, {
            "home": "中试基地",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "学院路2#",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器"]
            }]
        }, {
            "home": "求是楼",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器"]
            }]
        }, {
            "home": "三期宿舍食堂",
            "deskList": [{
                "name": "变压器",
                "loop": ["Ⅰ段进线变压器", "Ⅱ段进线变压器","Ⅲ段进线变压器","Ⅳ段进线变压器","Ⅴ段进线变压器"]
            }]
        }, {
            "home": "学院路1#",
            "deskList": [{
                "name": "变压器",
                "loop": ["1号变压器8176","2号变压器8176","3号变压器288线","4号变压器288线"]
            }]
        }];

        var navList = [];

        for (var i = 0; i < navMessage.length; i++) {
            if (home === navMessage[i].home)
                navList = navMessage[i].deskList;
        }
        return navList;

    }
</script>
</body>
>>>>>>> dedd623 (first)
>>>>>>> 19b8a9c (first)
>>>>>>> 8f5179a (first)
>>>>>>> 87a8fdf (first)
>>>>>>> 1e8021d (first)
>>>>>>> 5938de4 (first)
>>>>>>> c55f785 (first)
</html>